var xlsx2csv=(()=>{var cr=Object.create;var Qt=Object.defineProperty;var fr=Object.getOwnPropertyDescriptor;var dr=Object.getOwnPropertyNames;var pr=Object.getPrototypeOf,mr=Object.prototype.hasOwnProperty;var Vt=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(i,s)=>(typeof require<"u"?require:i)[s]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var Pt=(r,i)=>()=>(i||r((i={exports:{}}).exports,i),i.exports),_r=(r,i)=>{for(var s in i)Qt(r,s,{get:i[s],enumerable:!0})},Se=(r,i,s,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let h of dr(i))!mr.call(r,h)&&h!==s&&Qt(r,h,{get:()=>i[h],enumerable:!(e=fr(i,h))||e.enumerable});return r};var se=(r,i,s)=>(s=r!=null?cr(pr(r)):{},Se(i||!r||!r.__esModule?Qt(s,"default",{value:r,enumerable:!0}):s,r)),gr=r=>Se(Qt({},"__esModule",{value:!0}),r);var Te=Pt((De,ae)=>{(function(r){typeof De=="object"&&typeof ae<"u"?ae.exports=r():typeof define=="function"&&define.amd?define([],r):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=r()})(function(){return function r(i,s,e){function h(x,D){if(!s[x]){if(!i[x]){var k=typeof Vt=="function"&&Vt;if(!D&&k)return k(x,!0);if(o)return o(x,!0);var E=new Error("Cannot find module '"+x+"'");throw E.code="MODULE_NOT_FOUND",E}var u=s[x]={exports:{}};i[x][0].call(u.exports,function(g){var l=i[x][1][g];return h(l||g)},u,u.exports,r,i,s,e)}return s[x].exports}for(var o=typeof Vt=="function"&&Vt,f=0;f<e.length;f++)h(e[f]);return h}({1:[function(r,i,s){"use strict";var e=r("./utils"),h=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(f){for(var x,D,k,E,u,g,l,m=[],c=0,_=f.length,b=_,N=e.getTypeOf(f)!=="string";c<f.length;)b=_-c,k=N?(x=f[c++],D=c<_?f[c++]:0,c<_?f[c++]:0):(x=f.charCodeAt(c++),D=c<_?f.charCodeAt(c++):0,c<_?f.charCodeAt(c++):0),E=x>>2,u=(3&x)<<4|D>>4,g=1<b?(15&D)<<2|k>>6:64,l=2<b?63&k:64,m.push(o.charAt(E)+o.charAt(u)+o.charAt(g)+o.charAt(l));return m.join("")},s.decode=function(f){var x,D,k,E,u,g,l=0,m=0,c="data:";if(f.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var _,b=3*(f=f.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(f.charAt(f.length-1)===o.charAt(64)&&b--,f.charAt(f.length-2)===o.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=h.uint8array?new Uint8Array(0|b):new Array(0|b);l<f.length;)x=o.indexOf(f.charAt(l++))<<2|(E=o.indexOf(f.charAt(l++)))>>4,D=(15&E)<<4|(u=o.indexOf(f.charAt(l++)))>>2,k=(3&u)<<6|(g=o.indexOf(f.charAt(l++))),_[m++]=x,u!==64&&(_[m++]=D),g!==64&&(_[m++]=k);return _}},{"./support":30,"./utils":32}],2:[function(r,i,s){"use strict";var e=r("./external"),h=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),f=r("./stream/DataLengthProbe");function x(D,k,E,u,g){this.compressedSize=D,this.uncompressedSize=k,this.crc32=E,this.compression=u,this.compressedContent=g}x.prototype={getContentWorker:function(){var D=new h(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new f("data_length")),k=this;return D.on("end",function(){if(this.streamInfo.data_length!==k.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),D},getCompressedWorker:function(){return new h(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},x.createWorkerFrom=function(D,k,E){return D.pipe(new o).pipe(new f("uncompressedSize")).pipe(k.compressWorker(E)).pipe(new f("compressedSize")).withStreamInfo("compression",k)},i.exports=x},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,i,s){"use strict";var e=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new e("STORE compression")},uncompressWorker:function(){return new e("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,i,s){"use strict";var e=r("./utils"),h=function(){for(var o,f=[],x=0;x<256;x++){o=x;for(var D=0;D<8;D++)o=1&o?3988292384^o>>>1:o>>>1;f[x]=o}return f}();i.exports=function(o,f){return o!==void 0&&o.length?e.getTypeOf(o)!=="string"?function(x,D,k,E){var u=h,g=E+k;x^=-1;for(var l=E;l<g;l++)x=x>>>8^u[255&(x^D[l])];return-1^x}(0|f,o,o.length,0):function(x,D,k,E){var u=h,g=E+k;x^=-1;for(var l=E;l<g;l++)x=x>>>8^u[255&(x^D.charCodeAt(l))];return-1^x}(0|f,o,o.length,0):0}},{"./utils":32}],5:[function(r,i,s){"use strict";s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,i,s){"use strict";var e=null;e=typeof Promise<"u"?Promise:r("lie"),i.exports={Promise:e}},{lie:37}],7:[function(r,i,s){"use strict";var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",h=r("pako"),o=r("./utils"),f=r("./stream/GenericWorker"),x=e?"uint8array":"array";function D(k,E){f.call(this,"FlateWorker/"+k),this._pako=null,this._pakoAction=k,this._pakoOptions=E,this.meta={}}s.magic="\b\0",o.inherits(D,f),D.prototype.processChunk=function(k){this.meta=k.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(x,k.data),!1)},D.prototype.flush=function(){f.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new h[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var k=this;this._pako.onData=function(E){k.push({data:E,meta:k.meta})}},s.compressWorker=function(k){return new D("Deflate",k)},s.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,i,s){"use strict";function e(u,g){var l,m="";for(l=0;l<g;l++)m+=String.fromCharCode(255&u),u>>>=8;return m}function h(u,g,l,m,c,_){var b,N,R=u.file,$=u.compression,P=_!==x.utf8encode,W=o.transformTo("string",_(R.name)),L=o.transformTo("string",x.utf8encode(R.name)),q=R.comment,nt=o.transformTo("string",_(q)),C=o.transformTo("string",x.utf8encode(q)),U=L.length!==R.name.length,n=C.length!==q.length,H="",ht="",X="",ut=R.dir,G=R.date,at={crc32:0,compressedSize:0,uncompressedSize:0};g&&!l||(at.crc32=u.crc32,at.compressedSize=u.compressedSize,at.uncompressedSize=u.uncompressedSize);var M=0;g&&(M|=8),P||!U&&!n||(M|=2048);var z=0,lt=0;ut&&(z|=16),c==="UNIX"?(lt=798,z|=function(J,wt){var kt=J;return J||(kt=wt?16893:33204),(65535&kt)<<16}(R.unixPermissions,ut)):(lt=20,z|=function(J){return 63&(J||0)}(R.dosPermissions)),b=G.getUTCHours(),b<<=6,b|=G.getUTCMinutes(),b<<=5,b|=G.getUTCSeconds()/2,N=G.getUTCFullYear()-1980,N<<=4,N|=G.getUTCMonth()+1,N<<=5,N|=G.getUTCDate(),U&&(ht=e(1,1)+e(D(W),4)+L,H+="up"+e(ht.length,2)+ht),n&&(X=e(1,1)+e(D(nt),4)+C,H+="uc"+e(X.length,2)+X);var it="";return it+=`
\0`,it+=e(M,2),it+=$.magic,it+=e(b,2),it+=e(N,2),it+=e(at.crc32,4),it+=e(at.compressedSize,4),it+=e(at.uncompressedSize,4),it+=e(W.length,2),it+=e(H.length,2),{fileRecord:k.LOCAL_FILE_HEADER+it+W+H,dirRecord:k.CENTRAL_FILE_HEADER+e(lt,2)+it+e(nt.length,2)+"\0\0\0\0"+e(z,4)+e(m,4)+W+H+nt}}var o=r("../utils"),f=r("../stream/GenericWorker"),x=r("../utf8"),D=r("../crc32"),k=r("../signature");function E(u,g,l,m){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=l,this.encodeFileName=m,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(E,f),E.prototype.push=function(u){var g=u.meta.percent||0,l=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,f.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:l?(g+100*(l-m-1))/l:100}}))},E.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var g=this.streamFiles&&!u.file.dir;if(g){var l=h(u,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(u){this.accumulate=!1;var g=this.streamFiles&&!u.file.dir,l=h(u,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),g)this.push({data:function(m){return k.DATA_DESCRIPTOR+e(m.crc32,4)+e(m.compressedSize,4)+e(m.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var u=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var l=this.bytesWritten-u,m=function(c,_,b,N,R){var $=o.transformTo("string",R(N));return k.CENTRAL_DIRECTORY_END+"\0\0\0\0"+e(c,2)+e(c,2)+e(_,4)+e(b,4)+e($.length,2)+$}(this.dirRecords.length,l,u,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(u){this._sources.push(u);var g=this;return u.on("data",function(l){g.processChunk(l)}),u.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),u.on("error",function(l){g.error(l)}),this},E.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(u){var g=this._sources;if(!f.prototype.error.call(this,u))return!1;for(var l=0;l<g.length;l++)try{g[l].error(u)}catch{}return!0},E.prototype.lock=function(){f.prototype.lock.call(this);for(var u=this._sources,g=0;g<u.length;g++)u[g].lock()},i.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,i,s){"use strict";var e=r("../compressions"),h=r("./ZipFileWorker");s.generateWorker=function(o,f,x){var D=new h(f.streamFiles,x,f.platform,f.encodeFileName),k=0;try{o.forEach(function(E,u){k++;var g=function(_,b){var N=_||b,R=e[N];if(!R)throw new Error(N+" is not a valid compression method !");return R}(u.options.compression,f.compression),l=u.options.compressionOptions||f.compressionOptions||{},m=u.dir,c=u.date;u._compressWorker(g,l).withStreamInfo("file",{name:E,dir:m,date:c,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(D)}),D.entriesCount=k}catch(E){D.error(E)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,i,s){"use strict";function e(){if(!(this instanceof e))return new e;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var h=new e;for(var o in this)typeof this[o]!="function"&&(h[o]=this[o]);return h}}(e.prototype=r("./object")).loadAsync=r("./load"),e.support=r("./support"),e.defaults=r("./defaults"),e.version="3.10.1",e.loadAsync=function(h,o){return new e().loadAsync(h,o)},e.external=r("./external"),i.exports=e},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,i,s){"use strict";var e=r("./utils"),h=r("./external"),o=r("./utf8"),f=r("./zipEntries"),x=r("./stream/Crc32Probe"),D=r("./nodejsUtils");function k(E){return new h.Promise(function(u,g){var l=E.decompressed.getContentWorker().pipe(new x);l.on("error",function(m){g(m)}).on("end",function(){l.streamInfo.crc32!==E.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}i.exports=function(E,u){var g=this;return u=e.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),D.isNode&&D.isStream(E)?h.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",E,!0,u.optimizedBinaryString,u.base64).then(function(l){var m=new f(u);return m.load(l),m}).then(function(l){var m=[h.Promise.resolve(l)],c=l.files;if(u.checkCRC32)for(var _=0;_<c.length;_++)m.push(k(c[_]));return h.Promise.all(m)}).then(function(l){for(var m=l.shift(),c=m.files,_=0;_<c.length;_++){var b=c[_],N=b.fileNameStr,R=e.resolve(b.fileNameStr);g.file(R,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:u.createFolders}),b.dir||(g.file(R).unsafeOriginalName=N)}return m.zipComment.length&&(g.comment=m.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,i,s){"use strict";var e=r("../utils"),h=r("../stream/GenericWorker");function o(f,x){h.call(this,"Nodejs stream input adapter for "+f),this._upstreamEnded=!1,this._bindStream(x)}e.inherits(o,h),o.prototype._bindStream=function(f){var x=this;(this._stream=f).pause(),f.on("data",function(D){x.push({data:D,meta:{percent:0}})}).on("error",function(D){x.isPaused?this.generatedError=D:x.error(D)}).on("end",function(){x.isPaused?x._upstreamEnded=!0:x.end()})},o.prototype.pause=function(){return!!h.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,i,s){"use strict";var e=r("readable-stream").Readable;function h(o,f,x){e.call(this,f),this._helper=o;var D=this;o.on("data",function(k,E){D.push(k)||D._helper.pause(),x&&x(E)}).on("error",function(k){D.emit("error",k)}).on("end",function(){D.push(null)})}r("../utils").inherits(h,e),h.prototype._read=function(){this._helper.resume()},i.exports=h},{"../utils":32,"readable-stream":16}],14:[function(r,i,s){"use strict";i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,h){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,h);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,h)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var h=new Buffer(e);return h.fill(0),h},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}},{}],15:[function(r,i,s){"use strict";function e(R,$,P){var W,L=o.getTypeOf($),q=o.extend(P||{},D);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(R=c(R)),q.createFolders&&(W=m(R))&&_.call(this,W,!0);var nt=L==="string"&&q.binary===!1&&q.base64===!1;P&&P.binary!==void 0||(q.binary=!nt),($ instanceof k&&$.uncompressedSize===0||q.dir||!$||$.length===0)&&(q.base64=!1,q.binary=!0,$="",q.compression="STORE",L="string");var C=null;C=$ instanceof k||$ instanceof f?$:g.isNode&&g.isStream($)?new l(R,$):o.prepareContent(R,$,q.binary,q.optimizedBinaryString,q.base64);var U=new E(R,C,q);this.files[R]=U}var h=r("./utf8"),o=r("./utils"),f=r("./stream/GenericWorker"),x=r("./stream/StreamHelper"),D=r("./defaults"),k=r("./compressedObject"),E=r("./zipObject"),u=r("./generate"),g=r("./nodejsUtils"),l=r("./nodejs/NodejsStreamInputAdapter"),m=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var $=R.lastIndexOf("/");return 0<$?R.substring(0,$):""},c=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},_=function(R,$){return $=$!==void 0?$:D.createFolders,R=c(R),this.files[R]||e.call(this,R,null,{dir:!0,createFolders:$}),this.files[R]};function b(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var $,P,W;for($ in this.files)W=this.files[$],(P=$.slice(this.root.length,$.length))&&$.slice(0,this.root.length)===this.root&&R(P,W)},filter:function(R){var $=[];return this.forEach(function(P,W){R(P,W)&&$.push(W)}),$},file:function(R,$,P){if(arguments.length!==1)return R=this.root+R,e.call(this,R,$,P),this;if(b(R)){var W=R;return this.filter(function(q,nt){return!nt.dir&&W.test(q)})}var L=this.files[this.root+R];return L&&!L.dir?L:null},folder:function(R){if(!R)return this;if(b(R))return this.filter(function(L,q){return q.dir&&R.test(L)});var $=this.root+R,P=_.call(this,$),W=this.clone();return W.root=P.name,W},remove:function(R){R=this.root+R;var $=this.files[R];if($||(R.slice(-1)!=="/"&&(R+="/"),$=this.files[R]),$&&!$.dir)delete this.files[R];else for(var P=this.filter(function(L,q){return q.name.slice(0,R.length)===R}),W=0;W<P.length;W++)delete this.files[P[W].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var $,P={};try{if((P=o.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:h.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");o.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var W=P.comment||this.comment||"";$=u.generateWorker(this,P,W)}catch(L){($=new f("error")).error(L)}return new x($,P.type||"string",P.mimeType)},generateAsync:function(R,$){return this.generateInternalStream(R).accumulate($)},generateNodeStream:function(R,$){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream($)}};i.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,i,s){"use strict";i.exports=r("stream")},{stream:void 0}],17:[function(r,i,s){"use strict";var e=r("./DataReader");function h(o){e.call(this,o);for(var f=0;f<this.data.length;f++)o[f]=255&o[f]}r("../utils").inherits(h,e),h.prototype.byteAt=function(o){return this.data[this.zero+o]},h.prototype.lastIndexOfSignature=function(o){for(var f=o.charCodeAt(0),x=o.charCodeAt(1),D=o.charCodeAt(2),k=o.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===f&&this.data[E+1]===x&&this.data[E+2]===D&&this.data[E+3]===k)return E-this.zero;return-1},h.prototype.readAndCheckSignature=function(o){var f=o.charCodeAt(0),x=o.charCodeAt(1),D=o.charCodeAt(2),k=o.charCodeAt(3),E=this.readData(4);return f===E[0]&&x===E[1]&&D===E[2]&&k===E[3]},h.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./DataReader":18}],18:[function(r,i,s){"use strict";var e=r("../utils");function h(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}h.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var f,x=0;for(this.checkOffset(o),f=this.index+o-1;f>=this.index;f--)x=(x<<8)+this.byteAt(f);return this.index+=o,x},readString:function(o){return e.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=h},{"../utils":32}],19:[function(r,i,s){"use strict";var e=r("./Uint8ArrayReader");function h(o){e.call(this,o)}r("../utils").inherits(h,e),h.prototype.readData=function(o){this.checkOffset(o);var f=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,i,s){"use strict";var e=r("./DataReader");function h(o){e.call(this,o)}r("../utils").inherits(h,e),h.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},h.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},h.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},h.prototype.readData=function(o){this.checkOffset(o);var f=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./DataReader":18}],21:[function(r,i,s){"use strict";var e=r("./ArrayReader");function h(o){e.call(this,o)}r("../utils").inherits(h,e),h.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./ArrayReader":17}],22:[function(r,i,s){"use strict";var e=r("../utils"),h=r("../support"),o=r("./ArrayReader"),f=r("./StringReader"),x=r("./NodeBufferReader"),D=r("./Uint8ArrayReader");i.exports=function(k){var E=e.getTypeOf(k);return e.checkSupport(E),E!=="string"||h.uint8array?E==="nodebuffer"?new x(k):h.uint8array?new D(e.transformTo("uint8array",k)):new o(e.transformTo("array",k)):new f(k)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,i,s){"use strict";s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,i,s){"use strict";var e=r("./GenericWorker"),h=r("../utils");function o(f){e.call(this,"ConvertWorker to "+f),this.destType=f}h.inherits(o,e),o.prototype.processChunk=function(f){this.push({data:h.transformTo(this.destType,f.data),meta:f.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,i,s){"use strict";var e=r("./GenericWorker"),h=r("../crc32");function o(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(o,e),o.prototype.processChunk=function(f){this.streamInfo.crc32=h(f.data,this.streamInfo.crc32||0),this.push(f)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,i,s){"use strict";var e=r("../utils"),h=r("./GenericWorker");function o(f){h.call(this,"DataLengthProbe for "+f),this.propName=f,this.withStreamInfo(f,0)}e.inherits(o,h),o.prototype.processChunk=function(f){if(f){var x=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=x+f.data.length}h.prototype.processChunk.call(this,f)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,i,s){"use strict";var e=r("../utils"),h=r("./GenericWorker");function o(f){h.call(this,"DataWorker");var x=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(D){x.dataIsReady=!0,x.data=D,x.max=D&&D.length||0,x.type=e.getTypeOf(D),x.isPaused||x._tickAndRepeat()},function(D){x.error(D)})}e.inherits(o,h),o.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=null,x=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,x);break;case"uint8array":f=this.data.subarray(this.index,x);break;case"array":case"nodebuffer":f=this.data.slice(this.index,x)}return this.index=x,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(r,i,s){"use strict";function e(h){this.name=h||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}e.prototype={push:function(h){this.emit("data",h)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(h){this.emit("error",h)}return!0},error:function(h){return!this.isFinished&&(this.isPaused?this.generatedError=h:(this.isFinished=!0,this.emit("error",h),this.previous&&this.previous.error(h),this.cleanUp()),!0)},on:function(h,o){return this._listeners[h].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(h,o){if(this._listeners[h])for(var f=0;f<this._listeners[h].length;f++)this._listeners[h][f].call(this,o)},pipe:function(h){return h.registerPrevious(this)},registerPrevious:function(h){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=h.streamInfo,this.mergeStreamInfo(),this.previous=h;var o=this;return h.on("data",function(f){o.processChunk(f)}),h.on("end",function(){o.end()}),h.on("error",function(f){o.error(f)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var h=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),h=!0),this.previous&&this.previous.resume(),!h},flush:function(){},processChunk:function(h){this.push(h)},withStreamInfo:function(h,o){return this.extraStreamInfo[h]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var h in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,h)&&(this.streamInfo[h]=this.extraStreamInfo[h])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var h="Worker "+this.name;return this.previous?this.previous+" -> "+h:h}},i.exports=e},{}],29:[function(r,i,s){"use strict";var e=r("../utils"),h=r("./ConvertWorker"),o=r("./GenericWorker"),f=r("../base64"),x=r("../support"),D=r("../external"),k=null;if(x.nodestream)try{k=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(g,l){return new D.Promise(function(m,c){var _=[],b=g._internalType,N=g._outputType,R=g._mimeType;g.on("data",function($,P){_.push($),l&&l(P)}).on("error",function($){_=[],c($)}).on("end",function(){try{var $=function(P,W,L){switch(P){case"blob":return e.newBlob(e.transformTo("arraybuffer",W),L);case"base64":return f.encode(W);default:return e.transformTo(P,W)}}(N,function(P,W){var L,q=0,nt=null,C=0;for(L=0;L<W.length;L++)C+=W[L].length;switch(P){case"string":return W.join("");case"array":return Array.prototype.concat.apply([],W);case"uint8array":for(nt=new Uint8Array(C),L=0;L<W.length;L++)nt.set(W[L],q),q+=W[L].length;return nt;case"nodebuffer":return Buffer.concat(W);default:throw new Error("concat : unsupported type '"+P+"'")}}(b,_),R);m($)}catch(P){c(P)}_=[]}).resume()})}function u(g,l,m){var c=l;switch(l){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=l,this._mimeType=m,e.checkSupport(c),this._worker=g.pipe(new h(c)),g.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}u.prototype={accumulate:function(g){return E(this,g)},on:function(g,l){var m=this;return g==="data"?this._worker.on(g,function(c){l.call(m,c.data,c.meta)}):this._worker.on(g,function(){e.delay(l,arguments,m)}),this},resume:function(){return e.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(e.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new k(this,{objectMode:this._outputType!=="nodebuffer"},g)}},i.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,i,s){"use strict";if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var e=new ArrayBuffer(0);try{s.blob=new Blob([e],{type:"application/zip"}).size===0}catch{try{var h=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);h.append(e),s.blob=h.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,i,s){"use strict";for(var e=r("./utils"),h=r("./support"),o=r("./nodejsUtils"),f=r("./stream/GenericWorker"),x=new Array(256),D=0;D<256;D++)x[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;x[254]=x[254]=1;function k(){f.call(this,"utf-8 decode"),this.leftOver=null}function E(){f.call(this,"utf-8 encode")}s.utf8encode=function(u){return h.nodebuffer?o.newBufferFrom(u,"utf-8"):function(g){var l,m,c,_,b,N=g.length,R=0;for(_=0;_<N;_++)(64512&(m=g.charCodeAt(_)))==55296&&_+1<N&&(64512&(c=g.charCodeAt(_+1)))==56320&&(m=65536+(m-55296<<10)+(c-56320),_++),R+=m<128?1:m<2048?2:m<65536?3:4;for(l=h.uint8array?new Uint8Array(R):new Array(R),_=b=0;b<R;_++)(64512&(m=g.charCodeAt(_)))==55296&&_+1<N&&(64512&(c=g.charCodeAt(_+1)))==56320&&(m=65536+(m-55296<<10)+(c-56320),_++),m<128?l[b++]=m:(m<2048?l[b++]=192|m>>>6:(m<65536?l[b++]=224|m>>>12:(l[b++]=240|m>>>18,l[b++]=128|m>>>12&63),l[b++]=128|m>>>6&63),l[b++]=128|63&m);return l}(u)},s.utf8decode=function(u){return h.nodebuffer?e.transformTo("nodebuffer",u).toString("utf-8"):function(g){var l,m,c,_,b=g.length,N=new Array(2*b);for(l=m=0;l<b;)if((c=g[l++])<128)N[m++]=c;else if(4<(_=x[c]))N[m++]=65533,l+=_-1;else{for(c&=_===2?31:_===3?15:7;1<_&&l<b;)c=c<<6|63&g[l++],_--;1<_?N[m++]=65533:c<65536?N[m++]=c:(c-=65536,N[m++]=55296|c>>10&1023,N[m++]=56320|1023&c)}return N.length!==m&&(N.subarray?N=N.subarray(0,m):N.length=m),e.applyFromCharCode(N)}(u=e.transformTo(h.uint8array?"uint8array":"array",u))},e.inherits(k,f),k.prototype.processChunk=function(u){var g=e.transformTo(h.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(h.uint8array){var l=g;(g=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),g.set(l,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var m=function(_,b){var N;for((b=b||_.length)>_.length&&(b=_.length),N=b-1;0<=N&&(192&_[N])==128;)N--;return N<0||N===0?b:N+x[_[N]]>b?N:b}(g),c=g;m!==g.length&&(h.uint8array?(c=g.subarray(0,m),this.leftOver=g.subarray(m,g.length)):(c=g.slice(0,m),this.leftOver=g.slice(m,g.length))),this.push({data:s.utf8decode(c),meta:u.meta})},k.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=k,e.inherits(E,f),E.prototype.processChunk=function(u){this.push({data:s.utf8encode(u.data),meta:u.meta})},s.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,i,s){"use strict";var e=r("./support"),h=r("./base64"),o=r("./nodejsUtils"),f=r("./external");function x(l){return l}function D(l,m){for(var c=0;c<l.length;++c)m[c]=255&l.charCodeAt(c);return m}r("setimmediate"),s.newBlob=function(l,m){s.checkSupport("blob");try{return new Blob([l],{type:m})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(l),c.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var k={stringifyByChunk:function(l,m,c){var _=[],b=0,N=l.length;if(N<=c)return String.fromCharCode.apply(null,l);for(;b<N;)m==="array"||m==="nodebuffer"?_.push(String.fromCharCode.apply(null,l.slice(b,Math.min(b+c,N)))):_.push(String.fromCharCode.apply(null,l.subarray(b,Math.min(b+c,N)))),b+=c;return _.join("")},stringifyByChar:function(l){for(var m="",c=0;c<l.length;c++)m+=String.fromCharCode(l[c]);return m},applyCanBeUsed:{uint8array:function(){try{return e.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return e.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function E(l){var m=65536,c=s.getTypeOf(l),_=!0;if(c==="uint8array"?_=k.applyCanBeUsed.uint8array:c==="nodebuffer"&&(_=k.applyCanBeUsed.nodebuffer),_)for(;1<m;)try{return k.stringifyByChunk(l,c,m)}catch{m=Math.floor(m/2)}return k.stringifyByChar(l)}function u(l,m){for(var c=0;c<l.length;c++)m[c]=l[c];return m}s.applyFromCharCode=E;var g={};g.string={string:x,array:function(l){return D(l,new Array(l.length))},arraybuffer:function(l){return g.string.uint8array(l).buffer},uint8array:function(l){return D(l,new Uint8Array(l.length))},nodebuffer:function(l){return D(l,o.allocBuffer(l.length))}},g.array={string:E,array:x,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return o.newBufferFrom(l)}},g.arraybuffer={string:function(l){return E(new Uint8Array(l))},array:function(l){return u(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:x,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return o.newBufferFrom(new Uint8Array(l))}},g.uint8array={string:E,array:function(l){return u(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:x,nodebuffer:function(l){return o.newBufferFrom(l)}},g.nodebuffer={string:E,array:function(l){return u(l,new Array(l.length))},arraybuffer:function(l){return g.nodebuffer.uint8array(l).buffer},uint8array:function(l){return u(l,new Uint8Array(l.length))},nodebuffer:x},s.transformTo=function(l,m){if(m=m||"",!l)return m;s.checkSupport(l);var c=s.getTypeOf(m);return g[c][l](m)},s.resolve=function(l){for(var m=l.split("/"),c=[],_=0;_<m.length;_++){var b=m[_];b==="."||b===""&&_!==0&&_!==m.length-1||(b===".."?c.pop():c.push(b))}return c.join("/")},s.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":e.nodebuffer&&o.isBuffer(l)?"nodebuffer":e.uint8array&&l instanceof Uint8Array?"uint8array":e.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(l){if(!e[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(l){var m,c,_="";for(c=0;c<(l||"").length;c++)_+="\\x"+((m=l.charCodeAt(c))<16?"0":"")+m.toString(16).toUpperCase();return _},s.delay=function(l,m,c){setImmediate(function(){l.apply(c||null,m||[])})},s.inherits=function(l,m){function c(){}c.prototype=m.prototype,l.prototype=new c},s.extend=function(){var l,m,c={};for(l=0;l<arguments.length;l++)for(m in arguments[l])Object.prototype.hasOwnProperty.call(arguments[l],m)&&c[m]===void 0&&(c[m]=arguments[l][m]);return c},s.prepareContent=function(l,m,c,_,b){return f.Promise.resolve(m).then(function(N){return e.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new f.Promise(function(R,$){var P=new FileReader;P.onload=function(W){R(W.target.result)},P.onerror=function(W){$(W.target.error)},P.readAsArrayBuffer(N)}):N}).then(function(N){var R=s.getTypeOf(N);return R?(R==="arraybuffer"?N=s.transformTo("uint8array",N):R==="string"&&(b?N=h.decode(N):c&&_!==!0&&(N=function($){return D($,e.uint8array?new Uint8Array($.length):new Array($.length))}(N))),N):f.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,i,s){"use strict";var e=r("./reader/readerFor"),h=r("./utils"),o=r("./signature"),f=r("./zipEntry"),x=r("./support");function D(k){this.files=[],this.loadOptions=k}D.prototype={checkSignature:function(k){if(!this.reader.readAndCheckSignature(k)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+h.pretty(E)+", expected "+h.pretty(k)+")")}},isSignature:function(k,E){var u=this.reader.index;this.reader.setIndex(k);var g=this.reader.readString(4)===E;return this.reader.setIndex(u),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var k=this.reader.readData(this.zipCommentLength),E=x.uint8array?"uint8array":"array",u=h.transformTo(E,k);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var k,E,u,g=this.zip64EndOfCentralSize-44;0<g;)k=this.reader.readInt(2),E=this.reader.readInt(4),u=this.reader.readData(E),this.zip64ExtensibleData[k]={id:k,length:E,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var k,E;for(k=0;k<this.files.length;k++)E=this.files[k],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var k;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(k=new f({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(k);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var k=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(k<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(k);var E=k;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===h.MAX_VALUE_16BITS||this.diskWithCentralDirStart===h.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===h.MAX_VALUE_16BITS||this.centralDirRecords===h.MAX_VALUE_16BITS||this.centralDirSize===h.MAX_VALUE_32BITS||this.centralDirOffset===h.MAX_VALUE_32BITS){if(this.zip64=!0,(k=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(k),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var g=E-u;if(0<g)this.isSignature(E,o.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(k){this.reader=e(k)},load:function(k){this.prepareReader(k),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,i,s){"use strict";var e=r("./reader/readerFor"),h=r("./utils"),o=r("./compressedObject"),f=r("./crc32"),x=r("./utf8"),D=r("./compressions"),k=r("./support");function E(u,g){this.options=u,this.loadOptions=g}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var g,l;if(u.skip(22),this.fileNameLength=u.readInt(2),l=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(m){for(var c in D)if(Object.prototype.hasOwnProperty.call(D,c)&&D[c].magic===m)return D[c];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+h.pretty(this.compressionMethod)+" unknown (inner file : "+h.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,g,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var g=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(g),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=e(this.extraFields[1].value);this.uncompressedSize===h.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===h.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===h.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===h.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var g,l,m,c=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<c;)g=u.readInt(2),l=u.readInt(2),m=u.readData(l),this.extraFields[g]={id:g,length:l,value:m};u.setIndex(c)},handleUTF8:function(){var u=k.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=x.utf8decode(this.fileName),this.fileCommentStr=x.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var l=h.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var c=h.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var g=e(u.value);return g.readInt(1)!==1||f(this.fileName)!==g.readInt(4)?null:x.utf8decode(g.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var g=e(u.value);return g.readInt(1)!==1||f(this.fileComment)!==g.readInt(4)?null:x.utf8decode(g.readData(u.length-5))}return null}},i.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,i,s){"use strict";function e(g,l,m){this.name=g,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=l,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var h=r("./stream/StreamHelper"),o=r("./stream/DataWorker"),f=r("./utf8"),x=r("./compressedObject"),D=r("./stream/GenericWorker");e.prototype={internalStream:function(g){var l=null,m="string";try{if(!g)throw new Error("No output type specified.");var c=(m=g.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),l=this._decompressWorker();var _=!this._dataBinary;_&&!c&&(l=l.pipe(new f.Utf8EncodeWorker)),!_&&c&&(l=l.pipe(new f.Utf8DecodeWorker))}catch(b){(l=new D("error")).error(b)}return new h(l,m,"")},async:function(g,l){return this.internalStream(g).accumulate(l)},nodeStream:function(g,l){return this.internalStream(g||"nodebuffer").toNodejsStream(l)},_compressWorker:function(g,l){if(this._data instanceof x&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new f.Utf8EncodeWorker)),x.createWorkerFrom(m,g,l)},_decompressWorker:function(){return this._data instanceof x?this._data.getContentWorker():this._data instanceof D?this._data:new o(this._data)}};for(var k=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<k.length;u++)e.prototype[k[u]]=E;i.exports=e},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,i,s){(function(e){"use strict";var h,o,f=e.MutationObserver||e.WebKitMutationObserver;if(f){var x=0,D=new f(g),k=e.document.createTextNode("");D.observe(k,{characterData:!0}),h=function(){k.data=x=++x%2}}else if(e.setImmediate||e.MessageChannel===void 0)h="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var l=e.document.createElement("script");l.onreadystatechange=function(){g(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},e.document.documentElement.appendChild(l)}:function(){setTimeout(g,0)};else{var E=new e.MessageChannel;E.port1.onmessage=g,h=function(){E.port2.postMessage(0)}}var u=[];function g(){var l,m;o=!0;for(var c=u.length;c;){for(m=u,u=[],l=-1;++l<c;)m[l]();c=u.length}o=!1}i.exports=function(l){u.push(l)!==1||o||h()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,i,s){"use strict";var e=r("immediate");function h(){}var o={},f=["REJECTED"],x=["FULFILLED"],D=["PENDING"];function k(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,c!==h&&l(this,c)}function E(c,_,b){this.promise=c,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function u(c,_,b){e(function(){var N;try{N=_(b)}catch(R){return o.reject(c,R)}N===c?o.reject(c,new TypeError("Cannot resolve promise with itself")):o.resolve(c,N)})}function g(c){var _=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof _=="function")return function(){_.apply(c,arguments)}}function l(c,_){var b=!1;function N(P){b||(b=!0,o.reject(c,P))}function R(P){b||(b=!0,o.resolve(c,P))}var $=m(function(){_(R,N)});$.status==="error"&&N($.value)}function m(c,_){var b={};try{b.value=c(_),b.status="success"}catch(N){b.status="error",b.value=N}return b}(i.exports=k).prototype.finally=function(c){if(typeof c!="function")return this;var _=this.constructor;return this.then(function(b){return _.resolve(c()).then(function(){return b})},function(b){return _.resolve(c()).then(function(){throw b})})},k.prototype.catch=function(c){return this.then(null,c)},k.prototype.then=function(c,_){if(typeof c!="function"&&this.state===x||typeof _!="function"&&this.state===f)return this;var b=new this.constructor(h);return this.state!==D?u(b,this.state===x?c:_,this.outcome):this.queue.push(new E(b,c,_)),b},E.prototype.callFulfilled=function(c){o.resolve(this.promise,c)},E.prototype.otherCallFulfilled=function(c){u(this.promise,this.onFulfilled,c)},E.prototype.callRejected=function(c){o.reject(this.promise,c)},E.prototype.otherCallRejected=function(c){u(this.promise,this.onRejected,c)},o.resolve=function(c,_){var b=m(g,_);if(b.status==="error")return o.reject(c,b.value);var N=b.value;if(N)l(c,N);else{c.state=x,c.outcome=_;for(var R=-1,$=c.queue.length;++R<$;)c.queue[R].callFulfilled(_)}return c},o.reject=function(c,_){c.state=f,c.outcome=_;for(var b=-1,N=c.queue.length;++b<N;)c.queue[b].callRejected(_);return c},k.resolve=function(c){return c instanceof this?c:o.resolve(new this(h),c)},k.reject=function(c){var _=new this(h);return o.reject(_,c)},k.all=function(c){var _=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=c.length,N=!1;if(!b)return this.resolve([]);for(var R=new Array(b),$=0,P=-1,W=new this(h);++P<b;)L(c[P],P);return W;function L(q,nt){_.resolve(q).then(function(C){R[nt]=C,++$!==b||N||(N=!0,o.resolve(W,R))},function(C){N||(N=!0,o.reject(W,C))})}},k.race=function(c){var _=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=c.length,N=!1;if(!b)return this.resolve([]);for(var R=-1,$=new this(h);++R<b;)P=c[R],_.resolve(P).then(function(W){N||(N=!0,o.resolve($,W))},function(W){N||(N=!0,o.reject($,W))});var P;return $}},{immediate:36}],38:[function(r,i,s){"use strict";var e={};(0,r("./lib/utils/common").assign)(e,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),i.exports=e},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,i,s){"use strict";var e=r("./zlib/deflate"),h=r("./utils/common"),o=r("./utils/strings"),f=r("./zlib/messages"),x=r("./zlib/zstream"),D=Object.prototype.toString,k=0,E=-1,u=0,g=8;function l(c){if(!(this instanceof l))return new l(c);this.options=h.assign({level:E,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},c||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var b=e.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(b!==k)throw new Error(f[b]);if(_.header&&e.deflateSetHeader(this.strm,_.header),_.dictionary){var N;if(N=typeof _.dictionary=="string"?o.string2buf(_.dictionary):D.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(b=e.deflateSetDictionary(this.strm,N))!==k)throw new Error(f[b]);this._dict_set=!0}}function m(c,_){var b=new l(_);if(b.push(c,!0),b.err)throw b.msg||f[b.err];return b.result}l.prototype.push=function(c,_){var b,N,R=this.strm,$=this.options.chunkSize;if(this.ended)return!1;N=_===~~_?_:_===!0?4:0,typeof c=="string"?R.input=o.string2buf(c):D.call(c)==="[object ArrayBuffer]"?R.input=new Uint8Array(c):R.input=c,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new h.Buf8($),R.next_out=0,R.avail_out=$),(b=e.deflate(R,N))!==1&&b!==k)return this.onEnd(b),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(h.shrinkBuf(R.output,R.next_out))):this.onData(h.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&b!==1);return N===4?(b=e.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===k):N!==2||(this.onEnd(k),!(R.avail_out=0))},l.prototype.onData=function(c){this.chunks.push(c)},l.prototype.onEnd=function(c){c===k&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},s.Deflate=l,s.deflate=m,s.deflateRaw=function(c,_){return(_=_||{}).raw=!0,m(c,_)},s.gzip=function(c,_){return(_=_||{}).gzip=!0,m(c,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,i,s){"use strict";var e=r("./zlib/inflate"),h=r("./utils/common"),o=r("./utils/strings"),f=r("./zlib/constants"),x=r("./zlib/messages"),D=r("./zlib/zstream"),k=r("./zlib/gzheader"),E=Object.prototype.toString;function u(l){if(!(this instanceof u))return new u(l);this.options=h.assign({chunkSize:16384,windowBits:0,to:""},l||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||l&&l.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var c=e.inflateInit2(this.strm,m.windowBits);if(c!==f.Z_OK)throw new Error(x[c]);this.header=new k,e.inflateGetHeader(this.strm,this.header)}function g(l,m){var c=new u(m);if(c.push(l,!0),c.err)throw c.msg||x[c.err];return c.result}u.prototype.push=function(l,m){var c,_,b,N,R,$,P=this.strm,W=this.options.chunkSize,L=this.options.dictionary,q=!1;if(this.ended)return!1;_=m===~~m?m:m===!0?f.Z_FINISH:f.Z_NO_FLUSH,typeof l=="string"?P.input=o.binstring2buf(l):E.call(l)==="[object ArrayBuffer]"?P.input=new Uint8Array(l):P.input=l,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new h.Buf8(W),P.next_out=0,P.avail_out=W),(c=e.inflate(P,f.Z_NO_FLUSH))===f.Z_NEED_DICT&&L&&($=typeof L=="string"?o.string2buf(L):E.call(L)==="[object ArrayBuffer]"?new Uint8Array(L):L,c=e.inflateSetDictionary(this.strm,$)),c===f.Z_BUF_ERROR&&q===!0&&(c=f.Z_OK,q=!1),c!==f.Z_STREAM_END&&c!==f.Z_OK)return this.onEnd(c),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&c!==f.Z_STREAM_END&&(P.avail_in!==0||_!==f.Z_FINISH&&_!==f.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=o.utf8border(P.output,P.next_out),N=P.next_out-b,R=o.buf2string(P.output,b),P.next_out=N,P.avail_out=W-N,N&&h.arraySet(P.output,P.output,b,N,0),this.onData(R)):this.onData(h.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(q=!0)}while((0<P.avail_in||P.avail_out===0)&&c!==f.Z_STREAM_END);return c===f.Z_STREAM_END&&(_=f.Z_FINISH),_===f.Z_FINISH?(c=e.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===f.Z_OK):_!==f.Z_SYNC_FLUSH||(this.onEnd(f.Z_OK),!(P.avail_out=0))},u.prototype.onData=function(l){this.chunks.push(l)},u.prototype.onEnd=function(l){l===f.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},s.Inflate=u,s.inflate=g,s.inflateRaw=function(l,m){return(m=m||{}).raw=!0,g(l,m)},s.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,i,s){"use strict";var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(f){for(var x=Array.prototype.slice.call(arguments,1);x.length;){var D=x.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var k in D)D.hasOwnProperty(k)&&(f[k]=D[k])}}return f},s.shrinkBuf=function(f,x){return f.length===x?f:f.subarray?f.subarray(0,x):(f.length=x,f)};var h={arraySet:function(f,x,D,k,E){if(x.subarray&&f.subarray)f.set(x.subarray(D,D+k),E);else for(var u=0;u<k;u++)f[E+u]=x[D+u]},flattenChunks:function(f){var x,D,k,E,u,g;for(x=k=0,D=f.length;x<D;x++)k+=f[x].length;for(g=new Uint8Array(k),x=E=0,D=f.length;x<D;x++)u=f[x],g.set(u,E),E+=u.length;return g}},o={arraySet:function(f,x,D,k,E){for(var u=0;u<k;u++)f[E+u]=x[D+u]},flattenChunks:function(f){return[].concat.apply([],f)}};s.setTyped=function(f){f?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,h)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(e)},{}],42:[function(r,i,s){"use strict";var e=r("./common"),h=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{h=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var f=new e.Buf8(256),x=0;x<256;x++)f[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;function D(k,E){if(E<65537&&(k.subarray&&o||!k.subarray&&h))return String.fromCharCode.apply(null,e.shrinkBuf(k,E));for(var u="",g=0;g<E;g++)u+=String.fromCharCode(k[g]);return u}f[254]=f[254]=1,s.string2buf=function(k){var E,u,g,l,m,c=k.length,_=0;for(l=0;l<c;l++)(64512&(u=k.charCodeAt(l)))==55296&&l+1<c&&(64512&(g=k.charCodeAt(l+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),l++),_+=u<128?1:u<2048?2:u<65536?3:4;for(E=new e.Buf8(_),l=m=0;m<_;l++)(64512&(u=k.charCodeAt(l)))==55296&&l+1<c&&(64512&(g=k.charCodeAt(l+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),l++),u<128?E[m++]=u:(u<2048?E[m++]=192|u>>>6:(u<65536?E[m++]=224|u>>>12:(E[m++]=240|u>>>18,E[m++]=128|u>>>12&63),E[m++]=128|u>>>6&63),E[m++]=128|63&u);return E},s.buf2binstring=function(k){return D(k,k.length)},s.binstring2buf=function(k){for(var E=new e.Buf8(k.length),u=0,g=E.length;u<g;u++)E[u]=k.charCodeAt(u);return E},s.buf2string=function(k,E){var u,g,l,m,c=E||k.length,_=new Array(2*c);for(u=g=0;u<c;)if((l=k[u++])<128)_[g++]=l;else if(4<(m=f[l]))_[g++]=65533,u+=m-1;else{for(l&=m===2?31:m===3?15:7;1<m&&u<c;)l=l<<6|63&k[u++],m--;1<m?_[g++]=65533:l<65536?_[g++]=l:(l-=65536,_[g++]=55296|l>>10&1023,_[g++]=56320|1023&l)}return D(_,g)},s.utf8border=function(k,E){var u;for((E=E||k.length)>k.length&&(E=k.length),u=E-1;0<=u&&(192&k[u])==128;)u--;return u<0||u===0?E:u+f[k[u]]>E?u:E}},{"./common":41}],43:[function(r,i,s){"use strict";i.exports=function(e,h,o,f){for(var x=65535&e|0,D=e>>>16&65535|0,k=0;o!==0;){for(o-=k=2e3<o?2e3:o;D=D+(x=x+h[f++]|0)|0,--k;);x%=65521,D%=65521}return x|D<<16|0}},{}],44:[function(r,i,s){"use strict";i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,i,s){"use strict";var e=function(){for(var h,o=[],f=0;f<256;f++){h=f;for(var x=0;x<8;x++)h=1&h?3988292384^h>>>1:h>>>1;o[f]=h}return o}();i.exports=function(h,o,f,x){var D=e,k=x+f;h^=-1;for(var E=x;E<k;E++)h=h>>>8^D[255&(h^o[E])];return-1^h}},{}],46:[function(r,i,s){"use strict";var e,h=r("../utils/common"),o=r("./trees"),f=r("./adler32"),x=r("./crc32"),D=r("./messages"),k=0,E=4,u=0,g=-2,l=-1,m=4,c=2,_=8,b=9,N=286,R=30,$=19,P=2*N+1,W=15,L=3,q=258,nt=q+L+1,C=42,U=113,n=1,H=2,ht=3,X=4;function ut(t,p){return t.msg=D[p],p}function G(t){return(t<<1)-(4<t?9:0)}function at(t){for(var p=t.length;0<=--p;)t[p]=0}function M(t){var p=t.state,y=p.pending;y>t.avail_out&&(y=t.avail_out),y!==0&&(h.arraySet(t.output,p.pending_buf,p.pending_out,y,t.next_out),t.next_out+=y,p.pending_out+=y,t.total_out+=y,t.avail_out-=y,p.pending-=y,p.pending===0&&(p.pending_out=0))}function z(t,p){o._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,p),t.block_start=t.strstart,M(t.strm)}function lt(t,p){t.pending_buf[t.pending++]=p}function it(t,p){t.pending_buf[t.pending++]=p>>>8&255,t.pending_buf[t.pending++]=255&p}function J(t,p){var y,d,a=t.max_chain_length,w=t.strstart,B=t.prev_length,j=t.nice_match,O=t.strstart>t.w_size-nt?t.strstart-(t.w_size-nt):0,Q=t.window,tt=t.w_mask,Z=t.prev,st=t.strstart+q,mt=Q[w+B-1],ft=Q[w+B];t.prev_length>=t.good_match&&(a>>=2),j>t.lookahead&&(j=t.lookahead);do if(Q[(y=p)+B]===ft&&Q[y+B-1]===mt&&Q[y]===Q[w]&&Q[++y]===Q[w+1]){w+=2,y++;do;while(Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&Q[++w]===Q[++y]&&w<st);if(d=q-(st-w),w=st-q,B<d){if(t.match_start=p,j<=(B=d))break;mt=Q[w+B-1],ft=Q[w+B]}}while((p=Z[p&tt])>O&&--a!=0);return B<=t.lookahead?B:t.lookahead}function wt(t){var p,y,d,a,w,B,j,O,Q,tt,Z=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=Z+(Z-nt)){for(h.arraySet(t.window,t.window,Z,Z,0),t.match_start-=Z,t.strstart-=Z,t.block_start-=Z,p=y=t.hash_size;d=t.head[--p],t.head[p]=Z<=d?d-Z:0,--y;);for(p=y=Z;d=t.prev[--p],t.prev[p]=Z<=d?d-Z:0,--y;);a+=Z}if(t.strm.avail_in===0)break;if(B=t.strm,j=t.window,O=t.strstart+t.lookahead,Q=a,tt=void 0,tt=B.avail_in,Q<tt&&(tt=Q),y=tt===0?0:(B.avail_in-=tt,h.arraySet(j,B.input,B.next_in,tt,O),B.state.wrap===1?B.adler=f(B.adler,j,tt,O):B.state.wrap===2&&(B.adler=x(B.adler,j,tt,O)),B.next_in+=tt,B.total_in+=tt,tt),t.lookahead+=y,t.lookahead+t.insert>=L)for(w=t.strstart-t.insert,t.ins_h=t.window[w],t.ins_h=(t.ins_h<<t.hash_shift^t.window[w+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[w+L-1])&t.hash_mask,t.prev[w&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=w,w++,t.insert--,!(t.lookahead+t.insert<L)););}while(t.lookahead<nt&&t.strm.avail_in!==0)}function kt(t,p){for(var y,d;;){if(t.lookahead<nt){if(wt(t),t.lookahead<nt&&p===k)return n;if(t.lookahead===0)break}if(y=0,t.lookahead>=L&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,y=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),y!==0&&t.strstart-y<=t.w_size-nt&&(t.match_length=J(t,y)),t.match_length>=L)if(d=o._tr_tally(t,t.strstart-t.match_start,t.match_length-L),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=L){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,y=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else d=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(d&&(z(t,!1),t.strm.avail_out===0))return n}return t.insert=t.strstart<L-1?t.strstart:L-1,p===E?(z(t,!0),t.strm.avail_out===0?ht:X):t.last_lit&&(z(t,!1),t.strm.avail_out===0)?n:H}function dt(t,p){for(var y,d,a;;){if(t.lookahead<nt){if(wt(t),t.lookahead<nt&&p===k)return n;if(t.lookahead===0)break}if(y=0,t.lookahead>=L&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,y=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=L-1,y!==0&&t.prev_length<t.max_lazy_match&&t.strstart-y<=t.w_size-nt&&(t.match_length=J(t,y),t.match_length<=5&&(t.strategy===1||t.match_length===L&&4096<t.strstart-t.match_start)&&(t.match_length=L-1)),t.prev_length>=L&&t.match_length<=t.prev_length){for(a=t.strstart+t.lookahead-L,d=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-L),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=a&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,y=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=L-1,t.strstart++,d&&(z(t,!1),t.strm.avail_out===0))return n}else if(t.match_available){if((d=o._tr_tally(t,0,t.window[t.strstart-1]))&&z(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return n}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(d=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<L-1?t.strstart:L-1,p===E?(z(t,!0),t.strm.avail_out===0?ht:X):t.last_lit&&(z(t,!1),t.strm.avail_out===0)?n:H}function v(t,p,y,d,a){this.good_length=t,this.max_lazy=p,this.nice_length=y,this.max_chain=d,this.func=a}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new h.Buf16(2*P),this.dyn_dtree=new h.Buf16(2*(2*R+1)),this.bl_tree=new h.Buf16(2*(2*$+1)),at(this.dyn_ltree),at(this.dyn_dtree),at(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new h.Buf16(W+1),this.heap=new h.Buf16(2*N+1),at(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new h.Buf16(2*N+1),at(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(t){var p;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=c,(p=t.state).pending=0,p.pending_out=0,p.wrap<0&&(p.wrap=-p.wrap),p.status=p.wrap?C:U,t.adler=p.wrap===2?0:1,p.last_flush=k,o._tr_init(p),u):ut(t,g)}function et(t){var p=S(t);return p===u&&function(y){y.window_size=2*y.w_size,at(y.head),y.max_lazy_match=e[y.level].max_lazy,y.good_match=e[y.level].good_length,y.nice_match=e[y.level].nice_length,y.max_chain_length=e[y.level].max_chain,y.strstart=0,y.block_start=0,y.lookahead=0,y.insert=0,y.match_length=y.prev_length=L-1,y.match_available=0,y.ins_h=0}(t.state),p}function T(t,p,y,d,a,w){if(!t)return g;var B=1;if(p===l&&(p=6),d<0?(B=0,d=-d):15<d&&(B=2,d-=16),a<1||b<a||y!==_||d<8||15<d||p<0||9<p||w<0||m<w)return ut(t,g);d===8&&(d=9);var j=new A;return(t.state=j).strm=t,j.wrap=B,j.gzhead=null,j.w_bits=d,j.w_size=1<<j.w_bits,j.w_mask=j.w_size-1,j.hash_bits=a+7,j.hash_size=1<<j.hash_bits,j.hash_mask=j.hash_size-1,j.hash_shift=~~((j.hash_bits+L-1)/L),j.window=new h.Buf8(2*j.w_size),j.head=new h.Buf16(j.hash_size),j.prev=new h.Buf16(j.w_size),j.lit_bufsize=1<<a+6,j.pending_buf_size=4*j.lit_bufsize,j.pending_buf=new h.Buf8(j.pending_buf_size),j.d_buf=1*j.lit_bufsize,j.l_buf=3*j.lit_bufsize,j.level=p,j.strategy=w,j.method=y,et(t)}e=[new v(0,0,0,0,function(t,p){var y=65535;for(y>t.pending_buf_size-5&&(y=t.pending_buf_size-5);;){if(t.lookahead<=1){if(wt(t),t.lookahead===0&&p===k)return n;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var d=t.block_start+y;if((t.strstart===0||t.strstart>=d)&&(t.lookahead=t.strstart-d,t.strstart=d,z(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-nt&&(z(t,!1),t.strm.avail_out===0))return n}return t.insert=0,p===E?(z(t,!0),t.strm.avail_out===0?ht:X):(t.strstart>t.block_start&&(z(t,!1),t.strm.avail_out),n)}),new v(4,4,8,4,kt),new v(4,5,16,8,kt),new v(4,6,32,32,kt),new v(4,4,16,16,dt),new v(8,16,32,32,dt),new v(8,16,128,128,dt),new v(8,32,128,256,dt),new v(32,128,258,1024,dt),new v(32,258,258,4096,dt)],s.deflateInit=function(t,p){return T(t,p,_,15,8,0)},s.deflateInit2=T,s.deflateReset=et,s.deflateResetKeep=S,s.deflateSetHeader=function(t,p){return t&&t.state?t.state.wrap!==2?g:(t.state.gzhead=p,u):g},s.deflate=function(t,p){var y,d,a,w;if(!t||!t.state||5<p||p<0)return t?ut(t,g):g;if(d=t.state,!t.output||!t.input&&t.avail_in!==0||d.status===666&&p!==E)return ut(t,t.avail_out===0?-5:g);if(d.strm=t,y=d.last_flush,d.last_flush=p,d.status===C)if(d.wrap===2)t.adler=0,lt(d,31),lt(d,139),lt(d,8),d.gzhead?(lt(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),lt(d,255&d.gzhead.time),lt(d,d.gzhead.time>>8&255),lt(d,d.gzhead.time>>16&255),lt(d,d.gzhead.time>>24&255),lt(d,d.level===9?2:2<=d.strategy||d.level<2?4:0),lt(d,255&d.gzhead.os),d.gzhead.extra&&d.gzhead.extra.length&&(lt(d,255&d.gzhead.extra.length),lt(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(t.adler=x(t.adler,d.pending_buf,d.pending,0)),d.gzindex=0,d.status=69):(lt(d,0),lt(d,0),lt(d,0),lt(d,0),lt(d,0),lt(d,d.level===9?2:2<=d.strategy||d.level<2?4:0),lt(d,3),d.status=U);else{var B=_+(d.w_bits-8<<4)<<8;B|=(2<=d.strategy||d.level<2?0:d.level<6?1:d.level===6?2:3)<<6,d.strstart!==0&&(B|=32),B+=31-B%31,d.status=U,it(d,B),d.strstart!==0&&(it(d,t.adler>>>16),it(d,65535&t.adler)),t.adler=1}if(d.status===69)if(d.gzhead.extra){for(a=d.pending;d.gzindex<(65535&d.gzhead.extra.length)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),M(t),a=d.pending,d.pending!==d.pending_buf_size));)lt(d,255&d.gzhead.extra[d.gzindex]),d.gzindex++;d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),d.gzindex===d.gzhead.extra.length&&(d.gzindex=0,d.status=73)}else d.status=73;if(d.status===73)if(d.gzhead.name){a=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),M(t),a=d.pending,d.pending===d.pending_buf_size)){w=1;break}w=d.gzindex<d.gzhead.name.length?255&d.gzhead.name.charCodeAt(d.gzindex++):0,lt(d,w)}while(w!==0);d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),w===0&&(d.gzindex=0,d.status=91)}else d.status=91;if(d.status===91)if(d.gzhead.comment){a=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),M(t),a=d.pending,d.pending===d.pending_buf_size)){w=1;break}w=d.gzindex<d.gzhead.comment.length?255&d.gzhead.comment.charCodeAt(d.gzindex++):0,lt(d,w)}while(w!==0);d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),w===0&&(d.status=103)}else d.status=103;if(d.status===103&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&M(t),d.pending+2<=d.pending_buf_size&&(lt(d,255&t.adler),lt(d,t.adler>>8&255),t.adler=0,d.status=U)):d.status=U),d.pending!==0){if(M(t),t.avail_out===0)return d.last_flush=-1,u}else if(t.avail_in===0&&G(p)<=G(y)&&p!==E)return ut(t,-5);if(d.status===666&&t.avail_in!==0)return ut(t,-5);if(t.avail_in!==0||d.lookahead!==0||p!==k&&d.status!==666){var j=d.strategy===2?function(O,Q){for(var tt;;){if(O.lookahead===0&&(wt(O),O.lookahead===0)){if(Q===k)return n;break}if(O.match_length=0,tt=o._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++,tt&&(z(O,!1),O.strm.avail_out===0))return n}return O.insert=0,Q===E?(z(O,!0),O.strm.avail_out===0?ht:X):O.last_lit&&(z(O,!1),O.strm.avail_out===0)?n:H}(d,p):d.strategy===3?function(O,Q){for(var tt,Z,st,mt,ft=O.window;;){if(O.lookahead<=q){if(wt(O),O.lookahead<=q&&Q===k)return n;if(O.lookahead===0)break}if(O.match_length=0,O.lookahead>=L&&0<O.strstart&&(Z=ft[st=O.strstart-1])===ft[++st]&&Z===ft[++st]&&Z===ft[++st]){mt=O.strstart+q;do;while(Z===ft[++st]&&Z===ft[++st]&&Z===ft[++st]&&Z===ft[++st]&&Z===ft[++st]&&Z===ft[++st]&&Z===ft[++st]&&Z===ft[++st]&&st<mt);O.match_length=q-(mt-st),O.match_length>O.lookahead&&(O.match_length=O.lookahead)}if(O.match_length>=L?(tt=o._tr_tally(O,1,O.match_length-L),O.lookahead-=O.match_length,O.strstart+=O.match_length,O.match_length=0):(tt=o._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++),tt&&(z(O,!1),O.strm.avail_out===0))return n}return O.insert=0,Q===E?(z(O,!0),O.strm.avail_out===0?ht:X):O.last_lit&&(z(O,!1),O.strm.avail_out===0)?n:H}(d,p):e[d.level].func(d,p);if(j!==ht&&j!==X||(d.status=666),j===n||j===ht)return t.avail_out===0&&(d.last_flush=-1),u;if(j===H&&(p===1?o._tr_align(d):p!==5&&(o._tr_stored_block(d,0,0,!1),p===3&&(at(d.head),d.lookahead===0&&(d.strstart=0,d.block_start=0,d.insert=0))),M(t),t.avail_out===0))return d.last_flush=-1,u}return p!==E?u:d.wrap<=0?1:(d.wrap===2?(lt(d,255&t.adler),lt(d,t.adler>>8&255),lt(d,t.adler>>16&255),lt(d,t.adler>>24&255),lt(d,255&t.total_in),lt(d,t.total_in>>8&255),lt(d,t.total_in>>16&255),lt(d,t.total_in>>24&255)):(it(d,t.adler>>>16),it(d,65535&t.adler)),M(t),0<d.wrap&&(d.wrap=-d.wrap),d.pending!==0?u:1)},s.deflateEnd=function(t){var p;return t&&t.state?(p=t.state.status)!==C&&p!==69&&p!==73&&p!==91&&p!==103&&p!==U&&p!==666?ut(t,g):(t.state=null,p===U?ut(t,-3):u):g},s.deflateSetDictionary=function(t,p){var y,d,a,w,B,j,O,Q,tt=p.length;if(!t||!t.state||(w=(y=t.state).wrap)===2||w===1&&y.status!==C||y.lookahead)return g;for(w===1&&(t.adler=f(t.adler,p,tt,0)),y.wrap=0,tt>=y.w_size&&(w===0&&(at(y.head),y.strstart=0,y.block_start=0,y.insert=0),Q=new h.Buf8(y.w_size),h.arraySet(Q,p,tt-y.w_size,y.w_size,0),p=Q,tt=y.w_size),B=t.avail_in,j=t.next_in,O=t.input,t.avail_in=tt,t.next_in=0,t.input=p,wt(y);y.lookahead>=L;){for(d=y.strstart,a=y.lookahead-(L-1);y.ins_h=(y.ins_h<<y.hash_shift^y.window[d+L-1])&y.hash_mask,y.prev[d&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=d,d++,--a;);y.strstart=d,y.lookahead=L-1,wt(y)}return y.strstart+=y.lookahead,y.block_start=y.strstart,y.insert=y.lookahead,y.lookahead=0,y.match_length=y.prev_length=L-1,y.match_available=0,t.next_in=j,t.input=O,t.avail_in=B,y.wrap=w,u},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,i,s){"use strict";i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,i,s){"use strict";i.exports=function(e,h){var o,f,x,D,k,E,u,g,l,m,c,_,b,N,R,$,P,W,L,q,nt,C,U,n,H;o=e.state,f=e.next_in,n=e.input,x=f+(e.avail_in-5),D=e.next_out,H=e.output,k=D-(h-e.avail_out),E=D+(e.avail_out-257),u=o.dmax,g=o.wsize,l=o.whave,m=o.wnext,c=o.window,_=o.hold,b=o.bits,N=o.lencode,R=o.distcode,$=(1<<o.lenbits)-1,P=(1<<o.distbits)-1;t:do{b<15&&(_+=n[f++]<<b,b+=8,_+=n[f++]<<b,b+=8),W=N[_&$];e:for(;;){if(_>>>=L=W>>>24,b-=L,(L=W>>>16&255)===0)H[D++]=65535&W;else{if(!(16&L)){if((64&L)==0){W=N[(65535&W)+(_&(1<<L)-1)];continue e}if(32&L){o.mode=12;break t}e.msg="invalid literal/length code",o.mode=30;break t}q=65535&W,(L&=15)&&(b<L&&(_+=n[f++]<<b,b+=8),q+=_&(1<<L)-1,_>>>=L,b-=L),b<15&&(_+=n[f++]<<b,b+=8,_+=n[f++]<<b,b+=8),W=R[_&P];r:for(;;){if(_>>>=L=W>>>24,b-=L,!(16&(L=W>>>16&255))){if((64&L)==0){W=R[(65535&W)+(_&(1<<L)-1)];continue r}e.msg="invalid distance code",o.mode=30;break t}if(nt=65535&W,b<(L&=15)&&(_+=n[f++]<<b,(b+=8)<L&&(_+=n[f++]<<b,b+=8)),u<(nt+=_&(1<<L)-1)){e.msg="invalid distance too far back",o.mode=30;break t}if(_>>>=L,b-=L,(L=D-k)<nt){if(l<(L=nt-L)&&o.sane){e.msg="invalid distance too far back",o.mode=30;break t}if(U=c,(C=0)===m){if(C+=g-L,L<q){for(q-=L;H[D++]=c[C++],--L;);C=D-nt,U=H}}else if(m<L){if(C+=g+m-L,(L-=m)<q){for(q-=L;H[D++]=c[C++],--L;);if(C=0,m<q){for(q-=L=m;H[D++]=c[C++],--L;);C=D-nt,U=H}}}else if(C+=m-L,L<q){for(q-=L;H[D++]=c[C++],--L;);C=D-nt,U=H}for(;2<q;)H[D++]=U[C++],H[D++]=U[C++],H[D++]=U[C++],q-=3;q&&(H[D++]=U[C++],1<q&&(H[D++]=U[C++]))}else{for(C=D-nt;H[D++]=H[C++],H[D++]=H[C++],H[D++]=H[C++],2<(q-=3););q&&(H[D++]=H[C++],1<q&&(H[D++]=H[C++]))}break}}break}}while(f<x&&D<E);f-=q=b>>3,_&=(1<<(b-=q<<3))-1,e.next_in=f,e.next_out=D,e.avail_in=f<x?x-f+5:5-(f-x),e.avail_out=D<E?E-D+257:257-(D-E),o.hold=_,o.bits=b}},{}],49:[function(r,i,s){"use strict";var e=r("../utils/common"),h=r("./adler32"),o=r("./crc32"),f=r("./inffast"),x=r("./inftrees"),D=1,k=2,E=0,u=-2,g=1,l=852,m=592;function c(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(C){var U;return C&&C.state?(U=C.state,C.total_in=C.total_out=U.total=0,C.msg="",U.wrap&&(C.adler=1&U.wrap),U.mode=g,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new e.Buf32(l),U.distcode=U.distdyn=new e.Buf32(m),U.sane=1,U.back=-1,E):u}function N(C){var U;return C&&C.state?((U=C.state).wsize=0,U.whave=0,U.wnext=0,b(C)):u}function R(C,U){var n,H;return C&&C.state?(H=C.state,U<0?(n=0,U=-U):(n=1+(U>>4),U<48&&(U&=15)),U&&(U<8||15<U)?u:(H.window!==null&&H.wbits!==U&&(H.window=null),H.wrap=n,H.wbits=U,N(C))):u}function $(C,U){var n,H;return C?(H=new _,(C.state=H).window=null,(n=R(C,U))!==E&&(C.state=null),n):u}var P,W,L=!0;function q(C){if(L){var U;for(P=new e.Buf32(512),W=new e.Buf32(32),U=0;U<144;)C.lens[U++]=8;for(;U<256;)C.lens[U++]=9;for(;U<280;)C.lens[U++]=7;for(;U<288;)C.lens[U++]=8;for(x(D,C.lens,0,288,P,0,C.work,{bits:9}),U=0;U<32;)C.lens[U++]=5;x(k,C.lens,0,32,W,0,C.work,{bits:5}),L=!1}C.lencode=P,C.lenbits=9,C.distcode=W,C.distbits=5}function nt(C,U,n,H){var ht,X=C.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new e.Buf8(X.wsize)),H>=X.wsize?(e.arraySet(X.window,U,n-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(H<(ht=X.wsize-X.wnext)&&(ht=H),e.arraySet(X.window,U,n-H,ht,X.wnext),(H-=ht)?(e.arraySet(X.window,U,n-H,H,0),X.wnext=H,X.whave=X.wsize):(X.wnext+=ht,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=ht))),0}s.inflateReset=N,s.inflateReset2=R,s.inflateResetKeep=b,s.inflateInit=function(C){return $(C,15)},s.inflateInit2=$,s.inflate=function(C,U){var n,H,ht,X,ut,G,at,M,z,lt,it,J,wt,kt,dt,v,A,S,et,T,t,p,y,d,a=0,w=new e.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return u;(n=C.state).mode===12&&(n.mode=13),ut=C.next_out,ht=C.output,at=C.avail_out,X=C.next_in,H=C.input,G=C.avail_in,M=n.hold,z=n.bits,lt=G,it=at,p=E;t:for(;;)switch(n.mode){case g:if(n.wrap===0){n.mode=13;break}for(;z<16;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(2&n.wrap&&M===35615){w[n.check=0]=255&M,w[1]=M>>>8&255,n.check=o(n.check,w,2,0),z=M=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&M)<<8)+(M>>8))%31){C.msg="incorrect header check",n.mode=30;break}if((15&M)!=8){C.msg="unknown compression method",n.mode=30;break}if(z-=4,t=8+(15&(M>>>=4)),n.wbits===0)n.wbits=t;else if(t>n.wbits){C.msg="invalid window size",n.mode=30;break}n.dmax=1<<t,C.adler=n.check=1,n.mode=512&M?10:12,z=M=0;break;case 2:for(;z<16;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(n.flags=M,(255&n.flags)!=8){C.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){C.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=M>>8&1),512&n.flags&&(w[0]=255&M,w[1]=M>>>8&255,n.check=o(n.check,w,2,0)),z=M=0,n.mode=3;case 3:for(;z<32;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}n.head&&(n.head.time=M),512&n.flags&&(w[0]=255&M,w[1]=M>>>8&255,w[2]=M>>>16&255,w[3]=M>>>24&255,n.check=o(n.check,w,4,0)),z=M=0,n.mode=4;case 4:for(;z<16;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}n.head&&(n.head.xflags=255&M,n.head.os=M>>8),512&n.flags&&(w[0]=255&M,w[1]=M>>>8&255,n.check=o(n.check,w,2,0)),z=M=0,n.mode=5;case 5:if(1024&n.flags){for(;z<16;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}n.length=M,n.head&&(n.head.extra_len=M),512&n.flags&&(w[0]=255&M,w[1]=M>>>8&255,n.check=o(n.check,w,2,0)),z=M=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(G<(J=n.length)&&(J=G),J&&(n.head&&(t=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),e.arraySet(n.head.extra,H,X,J,t)),512&n.flags&&(n.check=o(n.check,H,J,X)),G-=J,X+=J,n.length-=J),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(G===0)break t;for(J=0;t=H[X+J++],n.head&&t&&n.length<65536&&(n.head.name+=String.fromCharCode(t)),t&&J<G;);if(512&n.flags&&(n.check=o(n.check,H,J,X)),G-=J,X+=J,t)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(G===0)break t;for(J=0;t=H[X+J++],n.head&&t&&n.length<65536&&(n.head.comment+=String.fromCharCode(t)),t&&J<G;);if(512&n.flags&&(n.check=o(n.check,H,J,X)),G-=J,X+=J,t)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;z<16;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(M!==(65535&n.check)){C.msg="header crc mismatch",n.mode=30;break}z=M=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),C.adler=n.check=0,n.mode=12;break;case 10:for(;z<32;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}C.adler=n.check=c(M),z=M=0,n.mode=11;case 11:if(n.havedict===0)return C.next_out=ut,C.avail_out=at,C.next_in=X,C.avail_in=G,n.hold=M,n.bits=z,2;C.adler=n.check=1,n.mode=12;case 12:if(U===5||U===6)break t;case 13:if(n.last){M>>>=7&z,z-=7&z,n.mode=27;break}for(;z<3;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}switch(n.last=1&M,z-=1,3&(M>>>=1)){case 0:n.mode=14;break;case 1:if(q(n),n.mode=20,U!==6)break;M>>>=2,z-=2;break t;case 2:n.mode=17;break;case 3:C.msg="invalid block type",n.mode=30}M>>>=2,z-=2;break;case 14:for(M>>>=7&z,z-=7&z;z<32;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if((65535&M)!=(M>>>16^65535)){C.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&M,z=M=0,n.mode=15,U===6)break t;case 15:n.mode=16;case 16:if(J=n.length){if(G<J&&(J=G),at<J&&(J=at),J===0)break t;e.arraySet(ht,H,X,J,ut),G-=J,X+=J,at-=J,ut+=J,n.length-=J;break}n.mode=12;break;case 17:for(;z<14;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(n.nlen=257+(31&M),M>>>=5,z-=5,n.ndist=1+(31&M),M>>>=5,z-=5,n.ncode=4+(15&M),M>>>=4,z-=4,286<n.nlen||30<n.ndist){C.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;z<3;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}n.lens[B[n.have++]]=7&M,M>>>=3,z-=3}for(;n.have<19;)n.lens[B[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,y={bits:n.lenbits},p=x(0,n.lens,0,19,n.lencode,0,n.work,y),n.lenbits=y.bits,p){C.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(a=n.lencode[M&(1<<n.lenbits)-1])>>>16&255,A=65535&a,!((dt=a>>>24)<=z);){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(A<16)M>>>=dt,z-=dt,n.lens[n.have++]=A;else{if(A===16){for(d=dt+2;z<d;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(M>>>=dt,z-=dt,n.have===0){C.msg="invalid bit length repeat",n.mode=30;break}t=n.lens[n.have-1],J=3+(3&M),M>>>=2,z-=2}else if(A===17){for(d=dt+3;z<d;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}z-=dt,t=0,J=3+(7&(M>>>=dt)),M>>>=3,z-=3}else{for(d=dt+7;z<d;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}z-=dt,t=0,J=11+(127&(M>>>=dt)),M>>>=7,z-=7}if(n.have+J>n.nlen+n.ndist){C.msg="invalid bit length repeat",n.mode=30;break}for(;J--;)n.lens[n.have++]=t}}if(n.mode===30)break;if(n.lens[256]===0){C.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,y={bits:n.lenbits},p=x(D,n.lens,0,n.nlen,n.lencode,0,n.work,y),n.lenbits=y.bits,p){C.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,y={bits:n.distbits},p=x(k,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,y),n.distbits=y.bits,p){C.msg="invalid distances set",n.mode=30;break}if(n.mode=20,U===6)break t;case 20:n.mode=21;case 21:if(6<=G&&258<=at){C.next_out=ut,C.avail_out=at,C.next_in=X,C.avail_in=G,n.hold=M,n.bits=z,f(C,it),ut=C.next_out,ht=C.output,at=C.avail_out,X=C.next_in,H=C.input,G=C.avail_in,M=n.hold,z=n.bits,n.mode===12&&(n.back=-1);break}for(n.back=0;v=(a=n.lencode[M&(1<<n.lenbits)-1])>>>16&255,A=65535&a,!((dt=a>>>24)<=z);){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(v&&(240&v)==0){for(S=dt,et=v,T=A;v=(a=n.lencode[T+((M&(1<<S+et)-1)>>S)])>>>16&255,A=65535&a,!(S+(dt=a>>>24)<=z);){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}M>>>=S,z-=S,n.back+=S}if(M>>>=dt,z-=dt,n.back+=dt,n.length=A,v===0){n.mode=26;break}if(32&v){n.back=-1,n.mode=12;break}if(64&v){C.msg="invalid literal/length code",n.mode=30;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(d=n.extra;z<d;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}n.length+=M&(1<<n.extra)-1,M>>>=n.extra,z-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(a=n.distcode[M&(1<<n.distbits)-1])>>>16&255,A=65535&a,!((dt=a>>>24)<=z);){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if((240&v)==0){for(S=dt,et=v,T=A;v=(a=n.distcode[T+((M&(1<<S+et)-1)>>S)])>>>16&255,A=65535&a,!(S+(dt=a>>>24)<=z);){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}M>>>=S,z-=S,n.back+=S}if(M>>>=dt,z-=dt,n.back+=dt,64&v){C.msg="invalid distance code",n.mode=30;break}n.offset=A,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(d=n.extra;z<d;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}n.offset+=M&(1<<n.extra)-1,M>>>=n.extra,z-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){C.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(at===0)break t;if(J=it-at,n.offset>J){if((J=n.offset-J)>n.whave&&n.sane){C.msg="invalid distance too far back",n.mode=30;break}wt=J>n.wnext?(J-=n.wnext,n.wsize-J):n.wnext-J,J>n.length&&(J=n.length),kt=n.window}else kt=ht,wt=ut-n.offset,J=n.length;for(at<J&&(J=at),at-=J,n.length-=J;ht[ut++]=kt[wt++],--J;);n.length===0&&(n.mode=21);break;case 26:if(at===0)break t;ht[ut++]=n.length,at--,n.mode=21;break;case 27:if(n.wrap){for(;z<32;){if(G===0)break t;G--,M|=H[X++]<<z,z+=8}if(it-=at,C.total_out+=it,n.total+=it,it&&(C.adler=n.check=n.flags?o(n.check,ht,it,ut-it):h(n.check,ht,it,ut-it)),it=at,(n.flags?M:c(M))!==n.check){C.msg="incorrect data check",n.mode=30;break}z=M=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;z<32;){if(G===0)break t;G--,M+=H[X++]<<z,z+=8}if(M!==(4294967295&n.total)){C.msg="incorrect length check",n.mode=30;break}z=M=0}n.mode=29;case 29:p=1;break t;case 30:p=-3;break t;case 31:return-4;case 32:default:return u}return C.next_out=ut,C.avail_out=at,C.next_in=X,C.avail_in=G,n.hold=M,n.bits=z,(n.wsize||it!==C.avail_out&&n.mode<30&&(n.mode<27||U!==4))&&nt(C,C.output,C.next_out,it-C.avail_out)?(n.mode=31,-4):(lt-=C.avail_in,it-=C.avail_out,C.total_in+=lt,C.total_out+=it,n.total+=it,n.wrap&&it&&(C.adler=n.check=n.flags?o(n.check,ht,it,C.next_out-it):h(n.check,ht,it,C.next_out-it)),C.data_type=n.bits+(n.last?64:0)+(n.mode===12?128:0)+(n.mode===20||n.mode===15?256:0),(lt==0&&it===0||U===4)&&p===E&&(p=-5),p)},s.inflateEnd=function(C){if(!C||!C.state)return u;var U=C.state;return U.window&&(U.window=null),C.state=null,E},s.inflateGetHeader=function(C,U){var n;return C&&C.state?(2&(n=C.state).wrap)==0?u:((n.head=U).done=!1,E):u},s.inflateSetDictionary=function(C,U){var n,H=U.length;return C&&C.state?(n=C.state).wrap!==0&&n.mode!==11?u:n.mode===11&&h(1,U,H,0)!==n.check?-3:nt(C,U,H,H)?(n.mode=31,-4):(n.havedict=1,E):u},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,i,s){"use strict";var e=r("../utils/common"),h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],x=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(D,k,E,u,g,l,m,c){var _,b,N,R,$,P,W,L,q,nt=c.bits,C=0,U=0,n=0,H=0,ht=0,X=0,ut=0,G=0,at=0,M=0,z=null,lt=0,it=new e.Buf16(16),J=new e.Buf16(16),wt=null,kt=0;for(C=0;C<=15;C++)it[C]=0;for(U=0;U<u;U++)it[k[E+U]]++;for(ht=nt,H=15;1<=H&&it[H]===0;H--);if(H<ht&&(ht=H),H===0)return g[l++]=20971520,g[l++]=20971520,c.bits=1,0;for(n=1;n<H&&it[n]===0;n++);for(ht<n&&(ht=n),C=G=1;C<=15;C++)if(G<<=1,(G-=it[C])<0)return-1;if(0<G&&(D===0||H!==1))return-1;for(J[1]=0,C=1;C<15;C++)J[C+1]=J[C]+it[C];for(U=0;U<u;U++)k[E+U]!==0&&(m[J[k[E+U]]++]=U);if(P=D===0?(z=wt=m,19):D===1?(z=h,lt-=257,wt=o,kt-=257,256):(z=f,wt=x,-1),C=n,$=l,ut=U=M=0,N=-1,R=(at=1<<(X=ht))-1,D===1&&852<at||D===2&&592<at)return 1;for(;;){for(W=C-ut,q=m[U]<P?(L=0,m[U]):m[U]>P?(L=wt[kt+m[U]],z[lt+m[U]]):(L=96,0),_=1<<C-ut,n=b=1<<X;g[$+(M>>ut)+(b-=_)]=W<<24|L<<16|q|0,b!==0;);for(_=1<<C-1;M&_;)_>>=1;if(_!==0?(M&=_-1,M+=_):M=0,U++,--it[C]==0){if(C===H)break;C=k[E+m[U]]}if(ht<C&&(M&R)!==N){for(ut===0&&(ut=ht),$+=n,G=1<<(X=C-ut);X+ut<H&&!((G-=it[X+ut])<=0);)X++,G<<=1;if(at+=1<<X,D===1&&852<at||D===2&&592<at)return 1;g[N=M&R]=ht<<24|X<<16|$-l|0}}return M!==0&&(g[$+M]=C-ut<<24|64<<16|0),c.bits=ht,0}},{"../utils/common":41}],51:[function(r,i,s){"use strict";i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,i,s){"use strict";var e=r("../utils/common"),h=0,o=1;function f(a){for(var w=a.length;0<=--w;)a[w]=0}var x=0,D=29,k=256,E=k+1+D,u=30,g=19,l=2*E+1,m=15,c=16,_=7,b=256,N=16,R=17,$=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],nt=new Array(2*(E+2));f(nt);var C=new Array(2*u);f(C);var U=new Array(512);f(U);var n=new Array(256);f(n);var H=new Array(D);f(H);var ht,X,ut,G=new Array(u);function at(a,w,B,j,O){this.static_tree=a,this.extra_bits=w,this.extra_base=B,this.elems=j,this.max_length=O,this.has_stree=a&&a.length}function M(a,w){this.dyn_tree=a,this.max_code=0,this.stat_desc=w}function z(a){return a<256?U[a]:U[256+(a>>>7)]}function lt(a,w){a.pending_buf[a.pending++]=255&w,a.pending_buf[a.pending++]=w>>>8&255}function it(a,w,B){a.bi_valid>c-B?(a.bi_buf|=w<<a.bi_valid&65535,lt(a,a.bi_buf),a.bi_buf=w>>c-a.bi_valid,a.bi_valid+=B-c):(a.bi_buf|=w<<a.bi_valid&65535,a.bi_valid+=B)}function J(a,w,B){it(a,B[2*w],B[2*w+1])}function wt(a,w){for(var B=0;B|=1&a,a>>>=1,B<<=1,0<--w;);return B>>>1}function kt(a,w,B){var j,O,Q=new Array(m+1),tt=0;for(j=1;j<=m;j++)Q[j]=tt=tt+B[j-1]<<1;for(O=0;O<=w;O++){var Z=a[2*O+1];Z!==0&&(a[2*O]=wt(Q[Z]++,Z))}}function dt(a){var w;for(w=0;w<E;w++)a.dyn_ltree[2*w]=0;for(w=0;w<u;w++)a.dyn_dtree[2*w]=0;for(w=0;w<g;w++)a.bl_tree[2*w]=0;a.dyn_ltree[2*b]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function v(a){8<a.bi_valid?lt(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function A(a,w,B,j){var O=2*w,Q=2*B;return a[O]<a[Q]||a[O]===a[Q]&&j[w]<=j[B]}function S(a,w,B){for(var j=a.heap[B],O=B<<1;O<=a.heap_len&&(O<a.heap_len&&A(w,a.heap[O+1],a.heap[O],a.depth)&&O++,!A(w,j,a.heap[O],a.depth));)a.heap[B]=a.heap[O],B=O,O<<=1;a.heap[B]=j}function et(a,w,B){var j,O,Q,tt,Z=0;if(a.last_lit!==0)for(;j=a.pending_buf[a.d_buf+2*Z]<<8|a.pending_buf[a.d_buf+2*Z+1],O=a.pending_buf[a.l_buf+Z],Z++,j===0?J(a,O,w):(J(a,(Q=n[O])+k+1,w),(tt=P[Q])!==0&&it(a,O-=H[Q],tt),J(a,Q=z(--j),B),(tt=W[Q])!==0&&it(a,j-=G[Q],tt)),Z<a.last_lit;);J(a,b,w)}function T(a,w){var B,j,O,Q=w.dyn_tree,tt=w.stat_desc.static_tree,Z=w.stat_desc.has_stree,st=w.stat_desc.elems,mt=-1;for(a.heap_len=0,a.heap_max=l,B=0;B<st;B++)Q[2*B]!==0?(a.heap[++a.heap_len]=mt=B,a.depth[B]=0):Q[2*B+1]=0;for(;a.heap_len<2;)Q[2*(O=a.heap[++a.heap_len]=mt<2?++mt:0)]=1,a.depth[O]=0,a.opt_len--,Z&&(a.static_len-=tt[2*O+1]);for(w.max_code=mt,B=a.heap_len>>1;1<=B;B--)S(a,Q,B);for(O=st;B=a.heap[1],a.heap[1]=a.heap[a.heap_len--],S(a,Q,1),j=a.heap[1],a.heap[--a.heap_max]=B,a.heap[--a.heap_max]=j,Q[2*O]=Q[2*B]+Q[2*j],a.depth[O]=(a.depth[B]>=a.depth[j]?a.depth[B]:a.depth[j])+1,Q[2*B+1]=Q[2*j+1]=O,a.heap[1]=O++,S(a,Q,1),2<=a.heap_len;);a.heap[--a.heap_max]=a.heap[1],function(ft,ot){var Y,F,I,rt,V,K,ct=ot.dyn_tree,gt=ot.max_code,vt=ot.stat_desc.static_tree,yt=ot.stat_desc.has_stree,pt=ot.stat_desc.extra_bits,It=ot.stat_desc.extra_base,Ot=ot.stat_desc.max_length,Nt=0;for(rt=0;rt<=m;rt++)ft.bl_count[rt]=0;for(ct[2*ft.heap[ft.heap_max]+1]=0,Y=ft.heap_max+1;Y<l;Y++)Ot<(rt=ct[2*ct[2*(F=ft.heap[Y])+1]+1]+1)&&(rt=Ot,Nt++),ct[2*F+1]=rt,gt<F||(ft.bl_count[rt]++,V=0,It<=F&&(V=pt[F-It]),K=ct[2*F],ft.opt_len+=K*(rt+V),yt&&(ft.static_len+=K*(vt[2*F+1]+V)));if(Nt!==0){do{for(rt=Ot-1;ft.bl_count[rt]===0;)rt--;ft.bl_count[rt]--,ft.bl_count[rt+1]+=2,ft.bl_count[Ot]--,Nt-=2}while(0<Nt);for(rt=Ot;rt!==0;rt--)for(F=ft.bl_count[rt];F!==0;)gt<(I=ft.heap[--Y])||(ct[2*I+1]!==rt&&(ft.opt_len+=(rt-ct[2*I+1])*ct[2*I],ct[2*I+1]=rt),F--)}}(a,w),kt(Q,mt,a.bl_count)}function t(a,w,B){var j,O,Q=-1,tt=w[1],Z=0,st=7,mt=4;for(tt===0&&(st=138,mt=3),w[2*(B+1)+1]=65535,j=0;j<=B;j++)O=tt,tt=w[2*(j+1)+1],++Z<st&&O===tt||(Z<mt?a.bl_tree[2*O]+=Z:O!==0?(O!==Q&&a.bl_tree[2*O]++,a.bl_tree[2*N]++):Z<=10?a.bl_tree[2*R]++:a.bl_tree[2*$]++,Q=O,mt=(Z=0)===tt?(st=138,3):O===tt?(st=6,3):(st=7,4))}function p(a,w,B){var j,O,Q=-1,tt=w[1],Z=0,st=7,mt=4;for(tt===0&&(st=138,mt=3),j=0;j<=B;j++)if(O=tt,tt=w[2*(j+1)+1],!(++Z<st&&O===tt)){if(Z<mt)for(;J(a,O,a.bl_tree),--Z!=0;);else O!==0?(O!==Q&&(J(a,O,a.bl_tree),Z--),J(a,N,a.bl_tree),it(a,Z-3,2)):Z<=10?(J(a,R,a.bl_tree),it(a,Z-3,3)):(J(a,$,a.bl_tree),it(a,Z-11,7));Q=O,mt=(Z=0)===tt?(st=138,3):O===tt?(st=6,3):(st=7,4)}}f(G);var y=!1;function d(a,w,B,j){it(a,(x<<1)+(j?1:0),3),function(O,Q,tt,Z){v(O),Z&&(lt(O,tt),lt(O,~tt)),e.arraySet(O.pending_buf,O.window,Q,tt,O.pending),O.pending+=tt}(a,w,B,!0)}s._tr_init=function(a){y||(function(){var w,B,j,O,Q,tt=new Array(m+1);for(O=j=0;O<D-1;O++)for(H[O]=j,w=0;w<1<<P[O];w++)n[j++]=O;for(n[j-1]=O,O=Q=0;O<16;O++)for(G[O]=Q,w=0;w<1<<W[O];w++)U[Q++]=O;for(Q>>=7;O<u;O++)for(G[O]=Q<<7,w=0;w<1<<W[O]-7;w++)U[256+Q++]=O;for(B=0;B<=m;B++)tt[B]=0;for(w=0;w<=143;)nt[2*w+1]=8,w++,tt[8]++;for(;w<=255;)nt[2*w+1]=9,w++,tt[9]++;for(;w<=279;)nt[2*w+1]=7,w++,tt[7]++;for(;w<=287;)nt[2*w+1]=8,w++,tt[8]++;for(kt(nt,E+1,tt),w=0;w<u;w++)C[2*w+1]=5,C[2*w]=wt(w,5);ht=new at(nt,P,k+1,E,m),X=new at(C,W,0,u,m),ut=new at(new Array(0),L,0,g,_)}(),y=!0),a.l_desc=new M(a.dyn_ltree,ht),a.d_desc=new M(a.dyn_dtree,X),a.bl_desc=new M(a.bl_tree,ut),a.bi_buf=0,a.bi_valid=0,dt(a)},s._tr_stored_block=d,s._tr_flush_block=function(a,w,B,j){var O,Q,tt=0;0<a.level?(a.strm.data_type===2&&(a.strm.data_type=function(Z){var st,mt=4093624447;for(st=0;st<=31;st++,mt>>>=1)if(1&mt&&Z.dyn_ltree[2*st]!==0)return h;if(Z.dyn_ltree[18]!==0||Z.dyn_ltree[20]!==0||Z.dyn_ltree[26]!==0)return o;for(st=32;st<k;st++)if(Z.dyn_ltree[2*st]!==0)return o;return h}(a)),T(a,a.l_desc),T(a,a.d_desc),tt=function(Z){var st;for(t(Z,Z.dyn_ltree,Z.l_desc.max_code),t(Z,Z.dyn_dtree,Z.d_desc.max_code),T(Z,Z.bl_desc),st=g-1;3<=st&&Z.bl_tree[2*q[st]+1]===0;st--);return Z.opt_len+=3*(st+1)+5+5+4,st}(a),O=a.opt_len+3+7>>>3,(Q=a.static_len+3+7>>>3)<=O&&(O=Q)):O=Q=B+5,B+4<=O&&w!==-1?d(a,w,B,j):a.strategy===4||Q===O?(it(a,2+(j?1:0),3),et(a,nt,C)):(it(a,4+(j?1:0),3),function(Z,st,mt,ft){var ot;for(it(Z,st-257,5),it(Z,mt-1,5),it(Z,ft-4,4),ot=0;ot<ft;ot++)it(Z,Z.bl_tree[2*q[ot]+1],3);p(Z,Z.dyn_ltree,st-1),p(Z,Z.dyn_dtree,mt-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,tt+1),et(a,a.dyn_ltree,a.dyn_dtree)),dt(a),j&&v(a)},s._tr_tally=function(a,w,B){return a.pending_buf[a.d_buf+2*a.last_lit]=w>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&w,a.pending_buf[a.l_buf+a.last_lit]=255&B,a.last_lit++,w===0?a.dyn_ltree[2*B]++:(a.matches++,w--,a.dyn_ltree[2*(n[B]+k+1)]++,a.dyn_dtree[2*z(w)]++),a.last_lit===a.lit_bufsize-1},s._tr_align=function(a){it(a,2,3),J(a,b,nt),function(w){w.bi_valid===16?(lt(w,w.bi_buf),w.bi_buf=0,w.bi_valid=0):8<=w.bi_valid&&(w.pending_buf[w.pending++]=255&w.bi_buf,w.bi_buf>>=8,w.bi_valid-=8)}(a)}},{"../utils/common":41}],53:[function(r,i,s){"use strict";i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,i,s){(function(e){(function(h,o){"use strict";if(!h.setImmediate){var f,x,D,k,E=1,u={},g=!1,l=h.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(h);m=m&&m.setTimeout?m:h,f={}.toString.call(h.process)==="[object process]"?function(N){process.nextTick(function(){_(N)})}:function(){if(h.postMessage&&!h.importScripts){var N=!0,R=h.onmessage;return h.onmessage=function(){N=!1},h.postMessage("","*"),h.onmessage=R,N}}()?(k="setImmediate$"+Math.random()+"$",h.addEventListener?h.addEventListener("message",b,!1):h.attachEvent("onmessage",b),function(N){h.postMessage(k+N,"*")}):h.MessageChannel?((D=new MessageChannel).port1.onmessage=function(N){_(N.data)},function(N){D.port2.postMessage(N)}):l&&"onreadystatechange"in l.createElement("script")?(x=l.documentElement,function(N){var R=l.createElement("script");R.onreadystatechange=function(){_(N),R.onreadystatechange=null,x.removeChild(R),R=null},x.appendChild(R)}):function(N){setTimeout(_,0,N)},m.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var R=new Array(arguments.length-1),$=0;$<R.length;$++)R[$]=arguments[$+1];var P={callback:N,args:R};return u[E]=P,f(E),E++},m.clearImmediate=c}function c(N){delete u[N]}function _(N){if(g)setTimeout(_,0,N);else{var R=u[N];if(R){g=!0;try{(function($){var P=$.callback,W=$.args;switch(W.length){case 0:P();break;case 1:P(W[0]);break;case 2:P(W[0],W[1]);break;case 3:P(W[0],W[1],W[2]);break;default:P.apply(o,W)}})(R)}finally{c(N),g=!1}}}}function b(N){N.source===h&&typeof N.data=="string"&&N.data.indexOf(k)===0&&_(+N.data.slice(k.length))}})(typeof self>"u"?e===void 0?this:e:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});var Oe=Pt(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.CHAR=`	
\r -\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}`;bt.S=` 	\r
`;bt.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";bt.NAME_CHAR="-"+bt.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";bt.CHAR_RE=new RegExp("^["+bt.CHAR+"]$","u");bt.S_RE=new RegExp("^["+bt.S+"]+$","u");bt.NAME_START_CHAR_RE=new RegExp("^["+bt.NAME_START_CHAR+"]$","u");bt.NAME_CHAR_RE=new RegExp("^["+bt.NAME_CHAR+"]$","u");bt.NAME_RE=new RegExp("^["+bt.NAME_START_CHAR+"]["+bt.NAME_CHAR+"]*$","u");bt.NMTOKEN_RE=new RegExp("^["+bt.NAME_CHAR+"]+$","u");var oe=9,he=10,le=13,ue=32;bt.S_LIST=[ue,he,le,oe];function br(r){return r>=ue&&r<=55295||r===he||r===le||r===oe||r>=57344&&r<=65533||r>=65536&&r<=1114111}bt.isChar=br;function xr(r){return r===ue||r===he||r===le||r===oe}bt.isS=xr;function Re(r){return r>=65&&r<=90||r>=97&&r<=122||r===58||r===95||r===8204||r===8205||r>=192&&r<=214||r>=216&&r<=246||r>=248&&r<=767||r>=880&&r<=893||r>=895&&r<=8191||r>=8304&&r<=8591||r>=11264&&r<=12271||r>=12289&&r<=55295||r>=63744&&r<=64975||r>=65008&&r<=65533||r>=65536&&r<=983039}bt.isNameStartChar=Re;function wr(r){return Re(r)||r>=48&&r<=57||r===45||r===46||r===183||r>=768&&r<=879||r>=8255&&r<=8256}bt.isNameChar=wr});var Le=Pt(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.CHAR="-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}";_t.RESTRICTED_CHAR="-\b\v\f-\x7F-\x84\x86-\x9F";_t.S=` 	\r
`;_t.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";_t.NAME_CHAR="-"+_t.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";_t.CHAR_RE=new RegExp("^["+_t.CHAR+"]$","u");_t.RESTRICTED_CHAR_RE=new RegExp("^["+_t.RESTRICTED_CHAR+"]$","u");_t.S_RE=new RegExp("^["+_t.S+"]+$","u");_t.NAME_START_CHAR_RE=new RegExp("^["+_t.NAME_START_CHAR+"]$","u");_t.NAME_CHAR_RE=new RegExp("^["+_t.NAME_CHAR+"]$","u");_t.NAME_RE=new RegExp("^["+_t.NAME_START_CHAR+"]["+_t.NAME_CHAR+"]*$","u");_t.NMTOKEN_RE=new RegExp("^["+_t.NAME_CHAR+"]+$","u");var Ie=9,ze=10,Me=13,Be=32;_t.S_LIST=[Be,ze,Me,Ie];function vr(r){return r>=1&&r<=55295||r>=57344&&r<=65533||r>=65536&&r<=1114111}_t.isChar=vr;function yr(r){return r>=1&&r<=8||r===11||r===12||r>=14&&r<=31||r>=127&&r<=132||r>=134&&r<=159}_t.isRestrictedChar=yr;function kr(r){return r===9||r===10||r===13||r>31&&r<127||r===133||r>159&&r<=55295||r>=57344&&r<=65533||r>=65536&&r<=1114111}_t.isCharAndNotRestricted=kr;function Cr(r){return r===Be||r===ze||r===Me||r===Ie}_t.isS=Cr;function Pe(r){return r>=65&&r<=90||r>=97&&r<=122||r===58||r===95||r===8204||r===8205||r>=192&&r<=214||r>=216&&r<=246||r>=248&&r<=767||r>=880&&r<=893||r>=895&&r<=8191||r>=8304&&r<=8591||r>=11264&&r<=12271||r>=12289&&r<=55295||r>=63744&&r<=64975||r>=65008&&r<=65533||r>=65536&&r<=983039}_t.isNameStartChar=Pe;function Er(r){return Pe(r)||r>=48&&r<=57||r===45||r===46||r===183||r>=768&&r<=879||r>=8255&&r<=8256}_t.isNameChar=Er});var $e=Pt(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.NC_NAME_START_CHAR="A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";St.NC_NAME_CHAR="-"+St.NC_NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";St.NC_NAME_START_CHAR_RE=new RegExp("^["+St.NC_NAME_START_CHAR+"]$","u");St.NC_NAME_CHAR_RE=new RegExp("^["+St.NC_NAME_CHAR+"]$","u");St.NC_NAME_RE=new RegExp("^["+St.NC_NAME_START_CHAR+"]["+St.NC_NAME_CHAR+"]*$","u");function Ue(r){return r>=65&&r<=90||r===95||r>=97&&r<=122||r>=192&&r<=214||r>=216&&r<=246||r>=248&&r<=767||r>=880&&r<=893||r>=895&&r<=8191||r>=8204&&r<=8205||r>=8304&&r<=8591||r>=11264&&r<=12271||r>=12289&&r<=55295||r>=63744&&r<=64975||r>=65008&&r<=65533||r>=65536&&r<=983039}St.isNCNameStartChar=Ue;function Ar(r){return Ue(r)||r===45||r===46||r>=48&&r<=57||r===183||r>=768&&r<=879||r>=8255&&r<=8256}St.isNCNameChar=Ar});var or=Pt(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.SaxesParser=jt.EVENTS=void 0;var Zt=Oe(),Sr=Le(),Ce=$e(),Dt=Zt.isS,Dr=Zt.isChar,qt=Zt.isNameStartChar,He=Zt.isNameChar,rr=Zt.S_LIST,Tr=Zt.NAME_RE,Fr=Sr.isChar,Nr=Ce.isNCNameStartChar,Rr=Ce.isNCNameChar,Or=Ce.NC_NAME_RE,ne="http://www.w3.org/XML/1998/namespace",Wt="http://www.w3.org/2000/xmlns/",Ir={__proto__:null,xml:ne,xmlns:Wt},zr={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},xt=-1,Rt=-2,We=0,Mr=1,ce=2,Br=3,Ut=4,Pr=5,Lr=6,Ur=7,fe=8,$r=9,Hr=10,Wr=11,jr=12,At=13,Jt=14,de=15,Zr=16,pe=17,Xr=18,Gr=19,me=20,Vr=21,qr=22,Kr=23,je=24,_e=25,te=26,Ze=27,Yr=28,Qr=29,Xe=30,Jr=31,ti=32,Mt=33,ei=34,ge=35,Kt=36,be=37,ri=38,Ge=39,Ve=40,ii=41,qe=42,ni=43,si=44,xe=9,Ft=10,we=13,Ke=32,Ye=33,ir=34,Yt=38,nr=39,ee=45,re=47,ai=59,zt=60,$t=61,Ct=62,Et=63,sr=91,Ht=93,Qe=133,Je=8232,ie=r=>r===ir||r===nr,ar=[ir,nr],oi=[...ar,sr,Ct],hi=[...ar,zt,Ht],li=[$t,Et,...rr],ui=[...rr,Ct,Yt,zt];function ye(r,i,s){switch(i){case"xml":s!==ne&&r.fail(`xml prefix must be bound to ${ne}.`);break;case"xmlns":s!==Wt&&r.fail(`xmlns prefix must be bound to ${Wt}.`);break;default:}switch(s){case Wt:r.fail(i===""?`the default namespace may not be set to ${s}.`:`may not assign a prefix (even "xmlns") to the URI ${Wt}.`);break;case ne:switch(i){case"xml":break;case"":r.fail(`the default namespace may not be set to ${s}.`);break;default:r.fail("may not assign the xml namespace to another prefix.")}break;default:}}function ci(r,i){for(let s of Object.keys(i))ye(r,s,i[s])}var fi=r=>Or.test(r),di=r=>Tr.test(r),Bt=0,tr=1,ve=2;jt.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];var er={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"},ke=class{constructor(i){this.opt=i??{},this.fragmentOpt=!!this.opt.fragment;let s=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,s){this.nameStartCheck=Nr,this.nameCheck=Rr,this.isName=fi,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},Ir);let e=this.opt.additionalNamespaces;e!=null&&(ci(this,e),Object.assign(this.ns,e))}else this.nameStartCheck=qt,this.nameCheck=He,this.isName=di,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var i;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=Bt,this.attribList=[];let{fragmentOpt:s}=this;this.state=s?At:We,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=s,this.xmlDeclPossible=!s,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:e}=this.opt;if(e===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");e="1.0"}this.setXMLVersion(e),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(zr),(i=this.readyHandler)===null||i===void 0||i.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(i,s){this[er[i]]=s}off(i){this[er[i]]=void 0}makeError(i){var s;let e=(s=this.fileName)!==null&&s!==void 0?s:"";return this.trackPosition&&(e.length>0&&(e+=":"),e+=`${this.line}:${this.column}`),e.length>0&&(e+=": "),new Error(e+i)}fail(i){let s=this.makeError(i),e=this.errorHandler;if(e===void 0)throw s;return e(s),this}write(i){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let s=!1;i===null?(s=!0,i=""):typeof i=="object"&&(i=i.toString()),this.carriedFromPrevious!==void 0&&(i=`${this.carriedFromPrevious}${i}`,this.carriedFromPrevious=void 0);let e=i.length,h=i.charCodeAt(e-1);!s&&(h===we||h>=55296&&h<=56319)&&(this.carriedFromPrevious=i[e-1],e--,i=i.slice(0,e));let{stateTable:o}=this;for(this.chunk=i,this.i=0;this.i<e;)o[this.state].call(this);return this.chunkPosition+=e,s?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:i,i:s}=this;if(this.prevI=s,this.i=s+1,s>=i.length)return xt;let e=i.charCodeAt(s);if(this.column++,e<55296){if(e>=Ke||e===xe)return e;switch(e){case Ft:return this.line++,this.column=0,this.positionAtNewLine=this.position,Ft;case we:return i.charCodeAt(s+1)===Ft&&(this.i=s+2),this.line++,this.column=0,this.positionAtNewLine=this.position,Rt;default:return this.fail("disallowed character."),e}}if(e>56319)return e>=57344&&e<=65533||this.fail("disallowed character."),e;let h=65536+(e-55296)*1024+(i.charCodeAt(s+1)-56320);return this.i=s+2,h>1114111&&this.fail("disallowed character."),h}getCode11(){let{chunk:i,i:s}=this;if(this.prevI=s,this.i=s+1,s>=i.length)return xt;let e=i.charCodeAt(s);if(this.column++,e<55296){if(e>31&&e<127||e>159&&e!==Je||e===xe)return e;switch(e){case Ft:return this.line++,this.column=0,this.positionAtNewLine=this.position,Ft;case we:{let o=i.charCodeAt(s+1);(o===Ft||o===Qe)&&(this.i=s+2)}case Qe:case Je:return this.line++,this.column=0,this.positionAtNewLine=this.position,Rt;default:return this.fail("disallowed character."),e}}if(e>56319)return e>=57344&&e<=65533||this.fail("disallowed character."),e;let h=65536+(e-55296)*1024+(i.charCodeAt(s+1)-56320);return this.i=s+2,h>1114111&&this.fail("disallowed character."),h}getCodeNorm(){let i=this.getCode();return i===Rt?Ft:i}unget(){this.i=this.prevI,this.column--}captureTo(i){let{i:s}=this,{chunk:e}=this;for(;;){let h=this.getCode(),o=h===Rt,f=o?Ft:h;if(f===xt||i.includes(f))return this.text+=e.slice(s,this.prevI),f;o&&(this.text+=`${e.slice(s,this.prevI)}
`,s=this.i)}}captureToChar(i){let{i:s}=this,{chunk:e}=this;for(;;){let h=this.getCode();switch(h){case Rt:this.text+=`${e.slice(s,this.prevI)}
`,s=this.i,h=Ft;break;case xt:return this.text+=e.slice(s),!1;default:}if(h===i)return this.text+=e.slice(s,this.prevI),!0}}captureNameChars(){let{chunk:i,i:s}=this;for(;;){let e=this.getCode();if(e===xt)return this.name+=i.slice(s),xt;if(!He(e))return this.name+=i.slice(s,this.prevI),e===Rt?Ft:e}}skipSpaces(){for(;;){let i=this.getCodeNorm();if(i===xt||!Dt(i))return i}}setXMLVersion(i){this.currentXMLVersion=i,i==="1.0"?(this.isChar=Dr,this.getCode=this.getCode10):(this.isChar=Fr,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=Mr}sBeginWhitespace(){let i=this.i,s=this.skipSpaces();switch(this.prevI!==i&&(this.xmlDeclPossible=!1),s){case zt:if(this.state=de,this.text.length!==0)throw new Error("no-empty text at start");break;case xt:break;default:this.unget(),this.state=At,this.xmlDeclPossible=!1}}sDoctype(){var i;let s=this.captureTo(oi);switch(s){case Ct:{(i=this.doctypeHandler)===null||i===void 0||i.call(this,this.text),this.text="",this.state=At,this.doctype=!0;break}case xt:break;default:this.text+=String.fromCodePoint(s),s===sr?this.state=Ut:ie(s)&&(this.state=Br,this.q=s)}}sDoctypeQuote(){let i=this.q;this.captureToChar(i)&&(this.text+=String.fromCodePoint(i),this.q=null,this.state=ce)}sDTD(){let i=this.captureTo(hi);i!==xt&&(this.text+=String.fromCodePoint(i),i===Ht?this.state=ce:i===zt?this.state=Lr:ie(i)&&(this.state=Pr,this.q=i))}sDTDQuoted(){let i=this.q;this.captureToChar(i)&&(this.text+=String.fromCodePoint(i),this.state=Ut,this.q=null)}sDTDOpenWaka(){let i=this.getCodeNorm();switch(this.text+=String.fromCodePoint(i),i){case Ye:this.state=Ur,this.openWakaBang="";break;case Et:this.state=Wr;break;default:this.state=Ut}}sDTDOpenWakaBang(){let i=String.fromCodePoint(this.getCodeNorm()),s=this.openWakaBang+=i;this.text+=i,s!=="-"&&(this.state=s==="--"?fe:Ut,this.openWakaBang="")}sDTDComment(){this.captureToChar(ee)&&(this.text+="-",this.state=$r)}sDTDCommentEnding(){let i=this.getCodeNorm();this.text+=String.fromCodePoint(i),this.state=i===ee?Hr:fe}sDTDCommentEnded(){let i=this.getCodeNorm();this.text+=String.fromCodePoint(i),i===Ct?this.state=Ut:(this.fail("malformed comment."),this.state=fe)}sDTDPI(){this.captureToChar(Et)&&(this.text+="?",this.state=jr)}sDTDPIEnding(){let i=this.getCodeNorm();this.text+=String.fromCodePoint(i),i===Ct&&(this.state=Ut)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i}=this,{chunk:s}=this;t:for(;;)switch(this.getCode()){case Rt:this.entity+=`${s.slice(i,this.prevI)}
`,i=this.i;break;case ai:{let{entityReturnState:e}=this,h=this.entity+s.slice(i,this.prevI);this.state=e;let o;h===""?(this.fail("empty entity name."),o="&;"):(o=this.parseEntity(h),this.entity=""),(e!==At||this.textHandler!==void 0)&&(this.text+=o);break t}case xt:this.entity+=s.slice(i);break t;default:}}sOpenWaka(){let i=this.getCode();if(qt(i))this.state=ei,this.unget(),this.xmlDeclPossible=!1;else switch(i){case re:this.state=ni,this.xmlDeclPossible=!1;break;case Ye:this.state=Zr,this.openWakaBang="",this.xmlDeclPossible=!1;break;case Et:this.state=Kr;break;default:this.fail("disallowed character in tag name"),this.state=At,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=me,this.openWakaBang="";break;case"--":this.state=pe,this.openWakaBang="";break;case"DOCTYPE":this.state=ce,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(ee)&&(this.state=Xr)}sCommentEnding(){var i;let s=this.getCodeNorm();s===ee?(this.state=Gr,(i=this.commentHandler)===null||i===void 0||i.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(s)}`,this.state=pe)}sCommentEnded(){let i=this.getCodeNorm();i!==Ct?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(i)}`,this.state=pe):this.state=At}sCData(){this.captureToChar(Ht)&&(this.state=Vr)}sCDataEnding(){let i=this.getCodeNorm();i===Ht?this.state=qr:(this.text+=`]${String.fromCodePoint(i)}`,this.state=me)}sCDataEnding2(){var i;let s=this.getCodeNorm();switch(s){case Ct:{(i=this.cdataHandler)===null||i===void 0||i.call(this,this.text),this.text="",this.state=At;break}case Ht:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(s)}`,this.state=me}}sPIFirstChar(){let i=this.getCodeNorm();this.nameStartCheck(i)?(this.piTarget+=String.fromCodePoint(i),this.state=je):i===Et||Dt(i)?(this.fail("processing instruction without a target."),this.state=i===Et?te:_e):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(i),this.state=je)}sPIRest(){let{chunk:i,i:s}=this;for(;;){let e=this.getCodeNorm();if(e===xt){this.piTarget+=i.slice(s);return}if(!this.nameCheck(e)){this.piTarget+=i.slice(s,this.prevI);let h=e===Et;h||Dt(e)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=h?Mt:Ze):this.state=h?te:_e:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e));break}}}sPIBody(){if(this.text.length===0){let i=this.getCodeNorm();i===Et?this.state=te:Dt(i)||(this.text=String.fromCodePoint(i))}else this.captureToChar(Et)&&(this.state=te)}sPIEnding(){var i;let s=this.getCodeNorm();if(s===Ct){let{piTarget:e}=this;e.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(i=this.piHandler)===null||i===void 0||i.call(this,{target:e,body:this.text}),this.piTarget=this.text="",this.state=At}else s===Et?this.text+="?":(this.text+=`?${String.fromCodePoint(s)}`,this.state=_e);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let i=this.skipSpaces();if(i===Et){this.state=Mt;return}i!==xt&&(this.state=Yr,this.name=String.fromCodePoint(i))}sXMLDeclName(){let i=this.captureTo(li);if(i===Et){this.state=Mt,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(!!(Dt(i)||i===$t)){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=i===$t?Xe:Qr}}sXMLDeclEq(){let i=this.getCodeNorm();if(i===Et){this.state=Mt,this.fail("XML declaration is incomplete.");return}Dt(i)||(i!==$t&&this.fail("value required."),this.state=Xe)}sXMLDeclValueStart(){let i=this.getCodeNorm();if(i===Et){this.state=Mt,this.fail("XML declaration is incomplete.");return}Dt(i)||(ie(i)?this.q=i:(this.fail("value must be quoted."),this.q=Ke),this.state=Jr)}sXMLDeclValue(){let i=this.captureTo([this.q,Et]);if(i===Et){this.state=Mt,this.text="",this.fail("XML declaration is incomplete.");return}if(i===xt)return;let s=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];let e=s;this.xmlDecl.version=e,/^1\.[0-9]+$/.test(e)?this.opt.forceXMLVersion||this.setXMLVersion(e):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(s)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=s;break;case"standalone":s!=="yes"&&s!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=s;break;default:}this.name="",this.state=ti}sXMLDeclSeparator(){let i=this.getCodeNorm();if(i===Et){this.state=Mt;return}Dt(i)||(this.fail("whitespace required."),this.unget()),this.state=Ze}sXMLDeclEnding(){var i;this.getCodeNorm()===Ct?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(i=this.xmldeclHandler)===null||i===void 0||i.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=At):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var i;let s=this.captureNameChars();if(s===xt)return;let e=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=e.ns=Object.create(null)),(i=this.openTagStartHandler)===null||i===void 0||i.call(this,e),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),s){case Ct:this.openTag();break;case re:this.state=ge;break;default:Dt(s)||this.fail("disallowed character in tag name."),this.state=Kt}}sOpenTagSlash(){this.getCode()===Ct?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=Kt)}sAttrib(){let i=this.skipSpaces();i!==xt&&(qt(i)?(this.unget(),this.state=be):i===Ct?this.openTag():i===re?this.state=ge:this.fail("disallowed character in attribute name."))}sAttribName(){let i=this.captureNameChars();i===$t?this.state=Ge:Dt(i)?this.state=ri:i===Ct?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):i!==xt&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let i=this.skipSpaces();switch(i){case xt:return;case $t:this.state=Ge;break;default:this.fail("attribute without value."),this.text="",this.name="",i===Ct?this.openTag():qt(i)?(this.unget(),this.state=be):(this.fail("disallowed character in attribute name."),this.state=Kt)}}sAttribValue(){let i=this.getCodeNorm();ie(i)?(this.q=i,this.state=Ve):Dt(i)||(this.fail("unquoted attribute value."),this.state=qe,this.unget())}sAttribValueQuoted(){let{q:i,chunk:s}=this,{i:e}=this;for(;;)switch(this.getCode()){case i:this.pushAttrib(this.name,this.text+s.slice(e,this.prevI)),this.name=this.text="",this.q=null,this.state=ii;return;case Yt:this.text+=s.slice(e,this.prevI),this.state=Jt,this.entityReturnState=Ve;return;case Ft:case Rt:case xe:this.text+=`${s.slice(e,this.prevI)} `,e=this.i;break;case zt:this.text+=s.slice(e,this.prevI),this.fail("disallowed character.");return;case xt:this.text+=s.slice(e);return;default:}}sAttribValueClosed(){let i=this.getCodeNorm();Dt(i)?this.state=Kt:i===Ct?this.openTag():i===re?this.state=ge:qt(i)?(this.fail("no whitespace between attributes."),this.unget(),this.state=be):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let i=this.captureTo(ui);switch(i){case Yt:this.state=Jt,this.entityReturnState=qe;break;case zt:this.fail("disallowed character.");break;case xt:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",i===Ct?this.openTag():this.state=Kt}}sCloseTag(){let i=this.captureNameChars();i===Ct?this.closeTag():Dt(i)?this.state=si:i!==xt&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case Ct:this.closeTag();break;case xt:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i,forbiddenState:s}=this,{chunk:e,textHandler:h}=this;t:for(;;)switch(this.getCode()){case zt:{if(this.state=de,h!==void 0){let{text:o}=this,f=e.slice(i,this.prevI);o.length!==0?(h(o+f),this.text=""):f.length!==0&&h(f)}s=Bt;break t}case Yt:this.state=Jt,this.entityReturnState=At,h!==void 0&&(this.text+=e.slice(i,this.prevI)),s=Bt;break t;case Ht:switch(s){case Bt:s=tr;break;case tr:s=ve;break;case ve:break;default:throw new Error("impossible state")}break;case Ct:s===ve&&this.fail('the string "]]>" is disallowed in char data.'),s=Bt;break;case Rt:h!==void 0&&(this.text+=`${e.slice(i,this.prevI)}
`),i=this.i,s=Bt;break;case xt:h!==void 0&&(this.text+=e.slice(i));break t;default:s=Bt}this.forbiddenState=s}handleTextOutsideRoot(){let{i}=this,{chunk:s,textHandler:e}=this,h=!1;t:for(;;){let o=this.getCode();switch(o){case zt:{if(this.state=de,e!==void 0){let{text:f}=this,x=s.slice(i,this.prevI);f.length!==0?(e(f+x),this.text=""):x.length!==0&&e(x)}break t}case Yt:this.state=Jt,this.entityReturnState=At,e!==void 0&&(this.text+=s.slice(i,this.prevI)),h=!0;break t;case Rt:e!==void 0&&(this.text+=`${s.slice(i,this.prevI)}
`),i=this.i;break;case xt:e!==void 0&&(this.text+=s.slice(i));break t;default:Dt(o)||(h=!0)}}!h||(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(i,s){var e;let{prefix:h,local:o}=this.qname(i),f={name:i,prefix:h,local:o,value:s};if(this.attribList.push(f),(e=this.attributeHandler)===null||e===void 0||e.call(this,f),h==="xmlns"){let x=s.trim();this.currentXMLVersion==="1.0"&&x===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[o]=x,ye(this,o,x)}else if(i==="xmlns"){let x=s.trim();this.topNS[""]=x,ye(this,"",x)}}pushAttribPlain(i,s){var e;let h={name:i,value:s};this.attribList.push(h),(e=this.attributeHandler)===null||e===void 0||e.call(this,h)}end(){var i,s;this.sawRoot||this.fail("document must contain a root element.");let{tags:e}=this;for(;e.length>0;){let o=e.pop();this.fail(`unclosed tag: ${o.name}`)}this.state!==We&&this.state!==At&&this.fail("unexpected end.");let{text:h}=this;return h.length!==0&&((i=this.textHandler)===null||i===void 0||i.call(this,h),this.text=""),this._closed=!0,(s=this.endHandler)===null||s===void 0||s.call(this),this._init(),this}resolve(i){var s,e;let h=this.topNS[i];if(h!==void 0)return h;let{tags:o}=this;for(let f=o.length-1;f>=0;f--)if(h=o[f].ns[i],h!==void 0)return h;return h=this.ns[i],h!==void 0?h:(e=(s=this.opt).resolvePrefix)===null||e===void 0?void 0:e.call(s,i)}qname(i){let s=i.indexOf(":");if(s===-1)return{prefix:"",local:i};let e=i.slice(s+1),h=i.slice(0,s);return(h===""||e===""||e.includes(":"))&&this.fail(`malformed name: ${i}.`),{prefix:h,local:e}}processAttribsNS(){var i;let{attribList:s}=this,e=this.tag;{let{prefix:f,local:x}=this.qname(e.name);e.prefix=f,e.local=x;let D=e.uri=(i=this.resolve(f))!==null&&i!==void 0?i:"";f!==""&&(f==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),D===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(f)}.`),e.uri=f))}if(s.length===0)return;let{attributes:h}=e,o=new Set;for(let f of s){let{name:x,prefix:D,local:k}=f,E,u;D===""?(E=x==="xmlns"?Wt:"",u=x):(E=this.resolve(D),E===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(D)}.`),E=D),u=`{${E}}${k}`),o.has(u)&&this.fail(`duplicate attribute: ${u}.`),o.add(u),f.uri=E,h[x]=f}this.attribList=[]}processAttribsPlain(){let{attribList:i}=this,s=this.tag.attributes;for(let{name:e,value:h}of i)s[e]!==void 0&&this.fail(`duplicate attribute: ${e}.`),s[e]=h;this.attribList=[]}openTag(){var i;this.processAttribs();let{tags:s}=this,e=this.tag;e.isSelfClosing=!1,(i=this.openTagHandler)===null||i===void 0||i.call(this,e),s.push(e),this.state=At,this.name=""}openSelfClosingTag(){var i,s,e;this.processAttribs();let{tags:h}=this,o=this.tag;o.isSelfClosing=!0,(i=this.openTagHandler)===null||i===void 0||i.call(this,o),(s=this.closeTagHandler)===null||s===void 0||s.call(this,o),(this.tag=(e=h[h.length-1])!==null&&e!==void 0?e:null)===null&&(this.closedRoot=!0),this.state=At,this.name=""}closeTag(){let{tags:i,name:s}=this;if(this.state=At,this.name="",s===""){this.fail("weird empty close tag."),this.text+="</>";return}let e=this.closeTagHandler,h=i.length;for(;h-- >0;){let o=this.tag=i.pop();if(this.topNS=o.ns,e?.(o),o.name===s)break;this.fail("unexpected close tag.")}h===0?this.closedRoot=!0:h<0&&(this.fail(`unmatched closing tag: ${s}.`),this.text+=`</${s}>`)}parseEntity(i){if(i[0]!=="#"){let e=this.ENTITIES[i];return e!==void 0?e:(this.fail(this.isName(i)?"undefined entity.":"disallowed character in entity name."),`&${i};`)}let s=NaN;return i[1]==="x"&&/^#x[0-9a-f]+$/i.test(i)?s=parseInt(i.slice(2),16):/^#[0-9]+$/.test(i)&&(s=parseInt(i.slice(1),10)),this.isChar(s)?String.fromCodePoint(s):(this.fail("malformed character entity."),`&${i};`)}};jt.SaxesParser=ke});var lr=Pt((Ci,Ee)=>{var hr={},pi=function(i){i.version="0.11.2";function s(v){for(var A="",S=v.length-1;S>=0;)A+=v.charAt(S--);return A}function e(v,A){for(var S="";S.length<A;)S+=v;return S}function h(v,A){var S=""+v;return S.length>=A?S:e("0",A-S.length)+S}function o(v,A){var S=""+v;return S.length>=A?S:e(" ",A-S.length)+S}function f(v,A){var S=""+v;return S.length>=A?S:S+e(" ",A-S.length)}function x(v,A){var S=""+Math.round(v);return S.length>=A?S:e("0",A-S.length)+S}function D(v,A){var S=""+v;return S.length>=A?S:e("0",A-S.length)+S}var k=Math.pow(2,32);function E(v,A){if(v>k||v<-k)return x(v,A);var S=Math.round(v);return D(S,A)}function u(v,A){return A=A||0,v.length>=7+A&&(v.charCodeAt(A)|32)===103&&(v.charCodeAt(A+1)|32)===101&&(v.charCodeAt(A+2)|32)===110&&(v.charCodeAt(A+3)|32)===101&&(v.charCodeAt(A+4)|32)===114&&(v.charCodeAt(A+5)|32)===97&&(v.charCodeAt(A+6)|32)===108}var g=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],l=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function m(v){v[0]="General",v[1]="0",v[2]="0.00",v[3]="#,##0",v[4]="#,##0.00",v[9]="0%",v[10]="0.00%",v[11]="0.00E+00",v[12]="# ?/?",v[13]="# ??/??",v[14]="m/d/yy",v[15]="d-mmm-yy",v[16]="d-mmm",v[17]="mmm-yy",v[18]="h:mm AM/PM",v[19]="h:mm:ss AM/PM",v[20]="h:mm",v[21]="h:mm:ss",v[22]="m/d/yy h:mm",v[37]="#,##0 ;(#,##0)",v[38]="#,##0 ;[Red](#,##0)",v[39]="#,##0.00;(#,##0.00)",v[40]="#,##0.00;[Red](#,##0.00)",v[45]="mm:ss",v[46]="[h]:mm:ss",v[47]="mmss.0",v[48]="##0.0E+0",v[49]="@",v[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var c={};m(c);var _=[],b=0;for(b=5;b<=8;++b)_[b]=32+b;for(b=23;b<=26;++b)_[b]=0;for(b=27;b<=31;++b)_[b]=14;for(b=50;b<=58;++b)_[b]=14;for(b=59;b<=62;++b)_[b]=b-58;for(b=67;b<=68;++b)_[b]=b-58;for(b=72;b<=75;++b)_[b]=b-58;for(b=67;b<=68;++b)_[b]=b-57;for(b=76;b<=78;++b)_[b]=b-56;for(b=79;b<=81;++b)_[b]=b-34;var N=[];N[5]=N[63]='"$"#,##0_);\\("$"#,##0\\)',N[6]=N[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',N[7]=N[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',N[8]=N[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',N[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',N[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',N[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',N[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function R(v,A,S){for(var et=v<0?-1:1,T=v*et,t=0,p=1,y=0,d=1,a=0,w=0,B=Math.floor(T);a<A&&(B=Math.floor(T),y=B*p+t,w=B*a+d,!(T-B<5e-8));)T=1/(T-B),t=p,p=y,d=a,a=w;if(w>A&&(a>A?(w=d,y=t):(w=a,y=p)),!S)return[0,et*y,w];var j=Math.floor(et*y/w);return[j,et*y-j*w,w]}function $(v,A,S){if(v>2958465||v<0)return null;var et=v|0,T=Math.floor(86400*(v-et)),t=0,p=[],y={D:et,T,u:86400*(v-et)-T,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(y.u)<1e-6&&(y.u=0),A&&A.date1904&&(et+=1462),y.u>.9999&&(y.u=0,++T==86400&&(y.T=T=0,++et,++y.D)),et===60)p=S?[1317,10,29]:[1900,2,29],t=3;else if(et===0)p=S?[1317,8,29]:[1900,1,0],t=6;else{et>60&&--et;var d=new Date(1900,0,1);d.setDate(d.getDate()+et-1),p=[d.getFullYear(),d.getMonth()+1,d.getDate()],t=d.getDay(),et<60&&(t=(t+6)%7),S&&(t=n(d,p))}return y.y=p[0],y.m=p[1],y.d=p[2],y.S=T%60,T=Math.floor(T/60),y.M=T%60,T=Math.floor(T/60),y.H=T,y.q=t,y}i.parse_date_code=$;var P=new Date(1899,11,31,0,0,0),W=P.getTime(),L=new Date(1900,2,1,0,0,0);function q(v,A){var S=v.getTime();return A?S-=1262304e5:v>=L&&(S+=864e5),(S-(W+(v.getTimezoneOffset()-P.getTimezoneOffset())*6e4))/864e5}function nt(v){return v.toString(10)}i._general_int=nt;var C=function(){var A=/(?:\.0*|(\.\d*[1-9])0+)$/;function S(a){return a.indexOf(".")==-1?a:a.replace(A,"$1")}var et=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,T=/(E[+-])(\d)$/;function t(a){return a.indexOf("E")==-1?a:a.replace(et,"$1E").replace(T,"$10$2")}function p(a){var w=a<0?12:11,B=S(a.toFixed(12));return B.length<=w||(B=a.toPrecision(10),B.length<=w)?B:a.toExponential(5)}function y(a){var w=S(a.toFixed(11));return w.length>(a<0?12:11)||w==="0"||w==="-0"?a.toPrecision(6):w}function d(a){var w=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),B;return w>=-4&&w<=-1?B=a.toPrecision(10+w):Math.abs(w)<=9?B=p(a):w===10?B=a.toFixed(10).substr(0,12):B=y(a),S(t(B.toUpperCase()))}return d}();i._general_num=C;function U(v,A){switch(typeof v){case"string":return v;case"boolean":return v?"TRUE":"FALSE";case"number":return(v|0)===v?v.toString(10):C(v);case"undefined":return"";case"object":if(v==null)return"";if(v instanceof Date)return kt(14,q(v,A&&A.date1904),A)}throw new Error("unsupported value in General format: "+v)}i._general=U;function n(v,A){A[0]-=581;var S=v.getDay();return v<60&&(S=(S+6)%7),S}var H="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function ht(v,A,S,et){var T="",t=0,p=0,y=S.y,d,a=0;switch(v){case 98:y=S.y+543;case 121:switch(A.length){case 1:case 2:d=y%100,a=2;break;default:d=y%1e4,a=4;break}break;case 109:switch(A.length){case 1:case 2:d=S.m,a=A.length;break;case 3:return l[S.m-1][1];case 5:return l[S.m-1][0];default:return l[S.m-1][2]}break;case 100:switch(A.length){case 1:case 2:d=S.d,a=A.length;break;case 3:return g[S.q][0];default:return g[S.q][1]}break;case 104:switch(A.length){case 1:case 2:d=1+(S.H+11)%12,a=A.length;break;default:throw"bad hour format: "+A}break;case 72:switch(A.length){case 1:case 2:d=S.H,a=A.length;break;default:throw"bad hour format: "+A}break;case 77:switch(A.length){case 1:case 2:d=S.M,a=A.length;break;default:throw"bad minute format: "+A}break;case 115:if(A!="s"&&A!="ss"&&A!=".0"&&A!=".00"&&A!=".000")throw"bad second format: "+A;return S.u===0&&(A=="s"||A=="ss")?h(S.S,A.length):(et>=2?p=et===3?1e3:100:p=et===1?10:1,t=Math.round(p*(S.S+S.u)),t>=60*p&&(t=0),A==="s"?t===0?"0":""+t/p:(T=h(t,2+et),A==="ss"?T.substr(0,2):"."+T.substr(2,A.length-1)));case 90:switch(A){case"[h]":case"[hh]":d=S.D*24+S.H;break;case"[m]":case"[mm]":d=(S.D*24+S.H)*60+S.M;break;case"[s]":case"[ss]":d=((S.D*24+S.H)*60+S.M)*60+Math.round(S.S+S.u);break;default:throw"bad abstime format: "+A}a=A.length===3?1:2;break;case 101:d=y,a=1;break}var w=a>0?h(d,a):"";return w}function X(v){var A=3;if(v.length<=A)return v;for(var S=v.length%A,et=v.substr(0,S);S!=v.length;S+=A)et+=(et.length>0?",":"")+v.substr(S,A);return et}var ut=function(){var A=/%/g;function S(Y,F,I){var rt=F.replace(A,""),V=F.length-rt.length;return ut(Y,rt,I*Math.pow(10,2*V))+e("%",V)}function et(Y,F,I){for(var rt=F.length-1;F.charCodeAt(rt-1)===44;)--rt;return ut(Y,F.substr(0,rt),I/Math.pow(10,3*(F.length-rt)))}function T(Y,F){var I,rt=Y.indexOf("E")-Y.indexOf(".")-1;if(Y.match(/^#+0.0E\+0$/)){if(F==0)return"0.0E+0";if(F<0)return"-"+T(Y,-F);var V=Y.indexOf(".");V===-1&&(V=Y.indexOf("E"));var K=Math.floor(Math.log(F)*Math.LOG10E)%V;if(K<0&&(K+=V),I=(F/Math.pow(10,K)).toPrecision(rt+1+(V+K)%V),I.indexOf("e")===-1){var ct=Math.floor(Math.log(F)*Math.LOG10E);for(I.indexOf(".")===-1?I=I.charAt(0)+"."+I.substr(1)+"E+"+(ct-I.length+K):I+="E+"+(ct-K);I.substr(0,2)==="0.";)I=I.charAt(0)+I.substr(2,V)+"."+I.substr(2+V),I=I.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");I=I.replace(/\+-/,"-")}I=I.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(gt,vt,yt,pt){return vt+yt+pt.substr(0,(V+K)%V)+"."+pt.substr(K)+"E"})}else I=F.toExponential(rt);return Y.match(/E\+00$/)&&I.match(/e[+-]\d$/)&&(I=I.substr(0,I.length-1)+"0"+I.charAt(I.length-1)),Y.match(/E\-/)&&I.match(/e\+/)&&(I=I.replace(/e\+/,"e")),I.replace("e","E")}var t=/# (\?+)( ?)\/( ?)(\d+)/;function p(Y,F,I){var rt=parseInt(Y[4],10),V=Math.round(F*rt),K=Math.floor(V/rt),ct=V-K*rt,gt=rt;return I+(K===0?"":""+K)+" "+(ct===0?e(" ",Y[1].length+1+Y[4].length):o(ct,Y[1].length)+Y[2]+"/"+Y[3]+h(gt,Y[4].length))}function y(Y,F,I){return I+(F===0?"":""+F)+e(" ",Y[1].length+2+Y[4].length)}var d=/^#*0*\.([0#]+)/,a=/\).*[0#]/,w=/\(###\) ###\\?-####/;function B(Y){for(var F="",I,rt=0;rt!=Y.length;++rt)switch(I=Y.charCodeAt(rt)){case 35:break;case 63:F+=" ";break;case 48:F+="0";break;default:F+=String.fromCharCode(I)}return F}function j(Y,F){var I=Math.pow(10,F);return""+Math.round(Y*I)/I}function O(Y,F){var I=Y-Math.floor(Y),rt=Math.pow(10,F);return F<(""+Math.round(I*rt)).length?0:Math.round(I*rt)}function Q(Y,F){return F<(""+Math.round((Y-Math.floor(Y))*Math.pow(10,F))).length?1:0}function tt(Y){return Y<2147483647&&Y>-2147483648?""+(Y>=0?Y|0:Y-1|0):""+Math.floor(Y)}function Z(Y,F,I){if(Y.charCodeAt(0)===40&&!F.match(a)){var rt=F.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return I>=0?Z("n",rt,I):"("+Z("n",rt,-I)+")"}if(F.charCodeAt(F.length-1)===44)return et(Y,F,I);if(F.indexOf("%")!==-1)return S(Y,F,I);if(F.indexOf("E")!==-1)return T(F,I);if(F.charCodeAt(0)===36)return"$"+Z(Y,F.substr(F.charAt(1)==" "?2:1),I);var V,K,ct,gt,vt=Math.abs(I),yt=I<0?"-":"";if(F.match(/^00+$/))return yt+E(vt,F.length);if(F.match(/^[#?]+$/))return V=E(I,0),V==="0"&&(V=""),V.length>F.length?V:B(F.substr(0,F.length-V.length))+V;if(K=F.match(t))return p(K,vt,yt);if(F.match(/^#+0+$/))return yt+E(vt,F.length-F.indexOf("0"));if(K=F.match(d))return V=j(I,K[1].length).replace(/^([^\.]+)$/,"$1."+B(K[1])).replace(/\.$/,"."+B(K[1])).replace(/\.(\d*)$/,function(Tt,Gt){return"."+Gt+e("0",B(K[1]).length-Gt.length)}),F.indexOf("0.")!==-1?V:V.replace(/^0\./,".");if(F=F.replace(/^#+([0.])/,"$1"),K=F.match(/^(0*)\.(#*)$/))return yt+j(vt,K[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,K[1].length?"0.":".");if(K=F.match(/^#{1,3},##0(\.?)$/))return yt+X(E(vt,0));if(K=F.match(/^#,##0\.([#0]*0)$/))return I<0?"-"+Z(Y,F,-I):X(""+(Math.floor(I)+Q(I,K[1].length)))+"."+h(O(I,K[1].length),K[1].length);if(K=F.match(/^#,#*,#0/))return Z(Y,F.replace(/^#,#*,/,""),I);if(K=F.match(/^([0#]+)(\\?-([0#]+))+$/))return V=s(Z(Y,F.replace(/[\\-]/g,""),I)),ct=0,s(s(F.replace(/\\/g,"")).replace(/[0#]/g,function(Tt){return ct<V.length?V.charAt(ct++):Tt==="0"?"0":""}));if(F.match(w))return V=Z(Y,"##########",I),"("+V.substr(0,3)+") "+V.substr(3,3)+"-"+V.substr(6);var pt="";if(K=F.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(K[4].length,7),gt=R(vt,Math.pow(10,ct)-1,!1),V=""+yt,pt=ut("n",K[1],gt[1]),pt.charAt(pt.length-1)==" "&&(pt=pt.substr(0,pt.length-1)+"0"),V+=pt+K[2]+"/"+K[3],pt=f(gt[2],ct),pt.length<K[4].length&&(pt=B(K[4].substr(K[4].length-pt.length))+pt),V+=pt,V;if(K=F.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(Math.max(K[1].length,K[4].length),7),gt=R(vt,Math.pow(10,ct)-1,!0),yt+(gt[0]||(gt[1]?"":"0"))+" "+(gt[1]?o(gt[1],ct)+K[2]+"/"+K[3]+f(gt[2],ct):e(" ",2*ct+1+K[2].length+K[3].length));if(K=F.match(/^[#0?]+$/))return V=E(I,0),F.length<=V.length?V:B(F.substr(0,F.length-V.length))+V;if(K=F.match(/^([#0?]+)\.([#0]+)$/)){V=""+I.toFixed(Math.min(K[2].length,10)).replace(/([^0])0+$/,"$1"),ct=V.indexOf(".");var It=F.indexOf(".")-ct,Ot=F.length-V.length-It;return B(F.substr(0,It)+V+F.substr(F.length-Ot))}if(K=F.match(/^00,000\.([#0]*0)$/))return ct=O(I,K[1].length),I<0?"-"+Z(Y,F,-I):X(tt(I)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Tt){return"00,"+(Tt.length<3?h(0,3-Tt.length):"")+Tt})+"."+h(ct,K[1].length);switch(F){case"###,##0.00":return Z(Y,"#,##0.00",I);case"###,###":case"##,###":case"#,###":var Nt=X(E(vt,0));return Nt!=="0"?yt+Nt:"";case"###,###.00":return Z(Y,"###,##0.00",I).replace(/^0\./,".");case"#,###.00":return Z(Y,"#,##0.00",I).replace(/^0\./,".");default:}throw new Error("unsupported format |"+F+"|")}function st(Y,F,I){for(var rt=F.length-1;F.charCodeAt(rt-1)===44;)--rt;return ut(Y,F.substr(0,rt),I/Math.pow(10,3*(F.length-rt)))}function mt(Y,F,I){var rt=F.replace(A,""),V=F.length-rt.length;return ut(Y,rt,I*Math.pow(10,2*V))+e("%",V)}function ft(Y,F){var I,rt=Y.indexOf("E")-Y.indexOf(".")-1;if(Y.match(/^#+0.0E\+0$/)){if(F==0)return"0.0E+0";if(F<0)return"-"+ft(Y,-F);var V=Y.indexOf(".");V===-1&&(V=Y.indexOf("E"));var K=Math.floor(Math.log(F)*Math.LOG10E)%V;if(K<0&&(K+=V),I=(F/Math.pow(10,K)).toPrecision(rt+1+(V+K)%V),!I.match(/[Ee]/)){var ct=Math.floor(Math.log(F)*Math.LOG10E);I.indexOf(".")===-1?I=I.charAt(0)+"."+I.substr(1)+"E+"+(ct-I.length+K):I+="E+"+(ct-K),I=I.replace(/\+-/,"-")}I=I.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(gt,vt,yt,pt){return vt+yt+pt.substr(0,(V+K)%V)+"."+pt.substr(K)+"E"})}else I=F.toExponential(rt);return Y.match(/E\+00$/)&&I.match(/e[+-]\d$/)&&(I=I.substr(0,I.length-1)+"0"+I.charAt(I.length-1)),Y.match(/E\-/)&&I.match(/e\+/)&&(I=I.replace(/e\+/,"e")),I.replace("e","E")}function ot(Y,F,I){if(Y.charCodeAt(0)===40&&!F.match(a)){var rt=F.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return I>=0?ot("n",rt,I):"("+ot("n",rt,-I)+")"}if(F.charCodeAt(F.length-1)===44)return st(Y,F,I);if(F.indexOf("%")!==-1)return mt(Y,F,I);if(F.indexOf("E")!==-1)return ft(F,I);if(F.charCodeAt(0)===36)return"$"+ot(Y,F.substr(F.charAt(1)==" "?2:1),I);var V,K,ct,gt,vt=Math.abs(I),yt=I<0?"-":"";if(F.match(/^00+$/))return yt+h(vt,F.length);if(F.match(/^[#?]+$/))return V=""+I,I===0&&(V=""),V.length>F.length?V:B(F.substr(0,F.length-V.length))+V;if(K=F.match(t))return y(K,vt,yt);if(F.match(/^#+0+$/))return yt+h(vt,F.length-F.indexOf("0"));if(K=F.match(d))return V=(""+I).replace(/^([^\.]+)$/,"$1."+B(K[1])).replace(/\.$/,"."+B(K[1])),V=V.replace(/\.(\d*)$/,function(Tt,Gt){return"."+Gt+e("0",B(K[1]).length-Gt.length)}),F.indexOf("0.")!==-1?V:V.replace(/^0\./,".");if(F=F.replace(/^#+([0.])/,"$1"),K=F.match(/^(0*)\.(#*)$/))return yt+(""+vt).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,K[1].length?"0.":".");if(K=F.match(/^#{1,3},##0(\.?)$/))return yt+X(""+vt);if(K=F.match(/^#,##0\.([#0]*0)$/))return I<0?"-"+ot(Y,F,-I):X(""+I)+"."+e("0",K[1].length);if(K=F.match(/^#,#*,#0/))return ot(Y,F.replace(/^#,#*,/,""),I);if(K=F.match(/^([0#]+)(\\?-([0#]+))+$/))return V=s(ot(Y,F.replace(/[\\-]/g,""),I)),ct=0,s(s(F.replace(/\\/g,"")).replace(/[0#]/g,function(Tt){return ct<V.length?V.charAt(ct++):Tt==="0"?"0":""}));if(F.match(w))return V=ot(Y,"##########",I),"("+V.substr(0,3)+") "+V.substr(3,3)+"-"+V.substr(6);var pt="";if(K=F.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(K[4].length,7),gt=R(vt,Math.pow(10,ct)-1,!1),V=""+yt,pt=ut("n",K[1],gt[1]),pt.charAt(pt.length-1)==" "&&(pt=pt.substr(0,pt.length-1)+"0"),V+=pt+K[2]+"/"+K[3],pt=f(gt[2],ct),pt.length<K[4].length&&(pt=B(K[4].substr(K[4].length-pt.length))+pt),V+=pt,V;if(K=F.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(Math.max(K[1].length,K[4].length),7),gt=R(vt,Math.pow(10,ct)-1,!0),yt+(gt[0]||(gt[1]?"":"0"))+" "+(gt[1]?o(gt[1],ct)+K[2]+"/"+K[3]+f(gt[2],ct):e(" ",2*ct+1+K[2].length+K[3].length));if(K=F.match(/^[#0?]+$/))return V=""+I,F.length<=V.length?V:B(F.substr(0,F.length-V.length))+V;if(K=F.match(/^([#0]+)\.([#0]+)$/)){V=""+I.toFixed(Math.min(K[2].length,10)).replace(/([^0])0+$/,"$1"),ct=V.indexOf(".");var It=F.indexOf(".")-ct,Ot=F.length-V.length-It;return B(F.substr(0,It)+V+F.substr(F.length-Ot))}if(K=F.match(/^00,000\.([#0]*0)$/))return I<0?"-"+ot(Y,F,-I):X(""+I).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Tt){return"00,"+(Tt.length<3?h(0,3-Tt.length):"")+Tt})+"."+h(0,K[1].length);switch(F){case"###,###":case"##,###":case"#,###":var Nt=X(""+vt);return Nt!=="0"?yt+Nt:"";default:if(F.match(/\.[0#?]*$/))return ot(Y,F.slice(0,F.lastIndexOf(".")),I)+B(F.slice(F.lastIndexOf(".")))}throw new Error("unsupported format |"+F+"|")}return function(F,I,rt){return(rt|0)===rt?ot(F,I,rt):Z(F,I,rt)}}();function G(v){for(var A=[],S=!1,et=0,T=0;et<v.length;++et)switch(v.charCodeAt(et)){case 34:S=!S;break;case 95:case 42:case 92:++et;break;case 59:A[A.length]=v.substr(T,et-T),T=et+1}if(A[A.length]=v.substr(T),S===!0)throw new Error("Format |"+v+"| unterminated string ");return A}i._split=G;var at=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function M(v){for(var A=0,S="",et="";A<v.length;)switch(S=v.charAt(A)){case"G":u(v,A)&&(A+=6),A++;break;case'"':for(;v.charCodeAt(++A)!==34&&A<v.length;);++A;break;case"\\":A+=2;break;case"_":A+=2;break;case"@":++A;break;case"B":case"b":if(v.charAt(A+1)==="1"||v.charAt(A+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(v.substr(A,3).toUpperCase()==="A/P"||v.substr(A,5).toUpperCase()==="AM/PM"||v.substr(A,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++A;break;case"[":for(et=S;v.charAt(A++)!=="]"&&A<v.length;)et+=v.charAt(A);if(et.match(at))return!0;break;case".":case"0":case"#":for(;A<v.length&&("0#?.,E+-%".indexOf(S=v.charAt(++A))>-1||S=="\\"&&v.charAt(A+1)=="-"&&"0#".indexOf(v.charAt(A+2))>-1););break;case"?":for(;v.charAt(++A)===S;);break;case"*":++A,(v.charAt(A)==" "||v.charAt(A)=="*")&&++A;break;case"(":case")":++A;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;A<v.length&&"0123456789".indexOf(v.charAt(++A))>-1;);break;case" ":++A;break;default:++A;break}return!1}i.is_date=M;function z(v,A,S,et){for(var T=[],t="",p=0,y="",d="t",a,w,B,j="H";p<v.length;)switch(y=v.charAt(p)){case"G":if(!u(v,p))throw new Error("unrecognized character "+y+" in "+v);T[T.length]={t:"G",v:"General"},p+=7;break;case'"':for(t="";(B=v.charCodeAt(++p))!==34&&p<v.length;)t+=String.fromCharCode(B);T[T.length]={t:"t",v:t},++p;break;case"\\":var O=v.charAt(++p),Q=O==="("||O===")"?O:"t";T[T.length]={t:Q,v:O},++p;break;case"_":T[T.length]={t:"t",v:" "},p+=2;break;case"@":T[T.length]={t:"T",v:A},++p;break;case"B":case"b":if(v.charAt(p+1)==="1"||v.charAt(p+1)==="2"){if(a==null&&(a=$(A,S,v.charAt(p+1)==="2"),a==null))return"";T[T.length]={t:"X",v:v.substr(p,2)},d=y,p+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":y=y.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(A<0||a==null&&(a=$(A,S),a==null))return"";for(t=y;++p<v.length&&v.charAt(p).toLowerCase()===y;)t+=y;y==="m"&&d.toLowerCase()==="h"&&(y="M"),y==="h"&&(y=j),T[T.length]={t:y,v:t},d=y;break;case"A":case"a":case"\u4E0A":var tt={t:y,v:y};if(a==null&&(a=$(A,S)),v.substr(p,3).toUpperCase()==="A/P"?(a!=null&&(tt.v=a.H>=12?"P":"A"),tt.t="T",j="h",p+=3):v.substr(p,5).toUpperCase()==="AM/PM"?(a!=null&&(tt.v=a.H>=12?"PM":"AM"),tt.t="T",p+=5,j="h"):v.substr(p,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(a!=null&&(tt.v=a.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),tt.t="T",p+=5,j="h"):(tt.t="t",++p),a==null&&tt.t==="T")return"";T[T.length]=tt,d=y;break;case"[":for(t=y;v.charAt(p++)!=="]"&&p<v.length;)t+=v.charAt(p);if(t.slice(-1)!=="]")throw'unterminated "[" block: |'+t+"|";if(t.match(at)){if(a==null&&(a=$(A,S),a==null))return"";T[T.length]={t:"Z",v:t.toLowerCase()},d=t.charAt(1)}else t.indexOf("$")>-1&&(t=(t.match(/\$([^-\[\]]*)/)||[])[1]||"$",M(v)||(T[T.length]={t:"t",v:t}));break;case".":if(a!=null){for(t=y;++p<v.length&&(y=v.charAt(p))==="0";)t+=y;T[T.length]={t:"s",v:t};break}case"0":case"#":for(t=y;++p<v.length&&"0#?.,E+-%".indexOf(y=v.charAt(p))>-1;)t+=y;T[T.length]={t:"n",v:t};break;case"?":for(t=y;v.charAt(++p)===y;)t+=y;T[T.length]={t:y,v:t},d=y;break;case"*":++p,(v.charAt(p)==" "||v.charAt(p)=="*")&&++p;break;case"(":case")":T[T.length]={t:et===1?"t":y,v:y},++p;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(t=y;p<v.length&&"0123456789".indexOf(v.charAt(++p))>-1;)t+=v.charAt(p);T[T.length]={t:"D",v:t};break;case" ":T[T.length]={t:y,v:y},++p;break;case"$":T[T.length]={t:"t",v:"$"},++p;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(y)===-1)throw new Error("unrecognized character "+y+" in "+v);T[T.length]={t:"t",v:y},++p;break}var Z=0,st=0,mt;for(p=T.length-1,d="t";p>=0;--p)switch(T[p].t){case"h":case"H":T[p].t=j,d="h",Z<1&&(Z=1);break;case"s":(mt=T[p].v.match(/\.0+$/))&&(st=Math.max(st,mt[0].length-1)),Z<3&&(Z=3);case"d":case"y":case"M":case"e":d=T[p].t;break;case"m":d==="s"&&(T[p].t="M",Z<2&&(Z=2));break;case"X":break;case"Z":Z<1&&T[p].v.match(/[Hh]/)&&(Z=1),Z<2&&T[p].v.match(/[Mm]/)&&(Z=2),Z<3&&T[p].v.match(/[Ss]/)&&(Z=3)}switch(Z){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M);break}var ft="",ot;for(p=0;p<T.length;++p)switch(T[p].t){case"t":case"T":case" ":case"D":break;case"X":T[p].v="",T[p].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":T[p].v=ht(T[p].t.charCodeAt(0),T[p].v,a,st),T[p].t="t";break;case"n":case"?":for(ot=p+1;T[ot]!=null&&((y=T[ot].t)==="?"||y==="D"||(y===" "||y==="t")&&T[ot+1]!=null&&(T[ot+1].t==="?"||T[ot+1].t==="t"&&T[ot+1].v==="/")||T[p].t==="("&&(y===" "||y==="n"||y===")")||y==="t"&&(T[ot].v==="/"||T[ot].v===" "&&T[ot+1]!=null&&T[ot+1].t=="?"));)T[p].v+=T[ot].v,T[ot]={v:"",t:";"},++ot;ft+=T[p].v,p=ot-1;break;case"G":T[p].t="t",T[p].v=U(A,S);break}var Y="",F,I;if(ft.length>0){ft.charCodeAt(0)==40?(F=A<0&&ft.charCodeAt(0)===45?-A:A,I=ut("n",ft,F)):(F=A<0&&et>1?-A:A,I=ut("n",ft,F),F<0&&T[0]&&T[0].t=="t"&&(I=I.substr(1),T[0].v="-"+T[0].v)),ot=I.length-1;var rt=T.length;for(p=0;p<T.length;++p)if(T[p]!=null&&T[p].t!="t"&&T[p].v.indexOf(".")>-1){rt=p;break}var V=T.length;if(rt===T.length&&I.indexOf("E")===-1){for(p=T.length-1;p>=0;--p)T[p]==null||"n?".indexOf(T[p].t)===-1||(ot>=T[p].v.length-1?(ot-=T[p].v.length,T[p].v=I.substr(ot+1,T[p].v.length)):ot<0?T[p].v="":(T[p].v=I.substr(0,ot+1),ot=-1),T[p].t="t",V=p);ot>=0&&V<T.length&&(T[V].v=I.substr(0,ot+1)+T[V].v)}else if(rt!==T.length&&I.indexOf("E")===-1){for(ot=I.indexOf(".")-1,p=rt;p>=0;--p)if(!(T[p]==null||"n?".indexOf(T[p].t)===-1)){for(w=T[p].v.indexOf(".")>-1&&p===rt?T[p].v.indexOf(".")-1:T[p].v.length-1,Y=T[p].v.substr(w+1);w>=0;--w)ot>=0&&(T[p].v.charAt(w)==="0"||T[p].v.charAt(w)==="#")&&(Y=I.charAt(ot--)+Y);T[p].v=Y,T[p].t="t",V=p}for(ot>=0&&V<T.length&&(T[V].v=I.substr(0,ot+1)+T[V].v),ot=I.indexOf(".")+1,p=rt;p<T.length;++p)if(!(T[p]==null||"n?(".indexOf(T[p].t)===-1&&p!==rt)){for(w=T[p].v.indexOf(".")>-1&&p===rt?T[p].v.indexOf(".")+1:0,Y=T[p].v.substr(0,w);w<T[p].v.length;++w)ot<I.length&&(Y+=I.charAt(ot++));T[p].v=Y,T[p].t="t",V=p}}}for(p=0;p<T.length;++p)T[p]!=null&&"n?".indexOf(T[p].t)>-1&&(F=et>1&&A<0&&p>0&&T[p-1].v==="-"?-A:A,T[p].v=ut(T[p].t,T[p].v,F),T[p].t="t");var K="";for(p=0;p!==T.length;++p)T[p]!=null&&(K+=T[p].v);return K}i._eval=z;var lt=/\[[=<>]/,it=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function J(v,A){if(A==null)return!1;var S=parseFloat(A[2]);switch(A[1]){case"=":if(v==S)return!0;break;case">":if(v>S)return!0;break;case"<":if(v<S)return!0;break;case"<>":if(v!=S)return!0;break;case">=":if(v>=S)return!0;break;case"<=":if(v<=S)return!0;break}return!1}function wt(v,A){var S=G(v),et=S.length,T=S[et-1].indexOf("@");if(et<4&&T>-1&&--et,S.length>4)throw new Error("cannot find right format for |"+S.join("|")+"|");if(typeof A!="number")return[4,S.length===4||T>-1?S[S.length-1]:"@"];switch(S.length){case 1:S=T>-1?["General","General","General",S[0]]:[S[0],S[0],S[0],"@"];break;case 2:S=T>-1?[S[0],S[0],S[0],S[1]]:[S[0],S[1],S[0],"@"];break;case 3:S=T>-1?[S[0],S[1],S[0],S[2]]:[S[0],S[1],S[2],"@"];break;case 4:break}var t=A>0?S[0]:A<0?S[1]:S[2];if(S[0].indexOf("[")===-1&&S[1].indexOf("[")===-1)return[et,t];if(S[0].match(lt)!=null||S[1].match(lt)!=null){var p=S[0].match(it),y=S[1].match(it);return J(A,p)?[et,S[0]]:J(A,y)?[et,S[1]]:[et,S[p!=null&&y!=null?2:1]]}return[et,t]}function kt(v,A,S){S==null&&(S={});var et="";switch(typeof v){case"string":v=="m/d/yy"&&S.dateNF?et=S.dateNF:et=v;break;case"number":v==14&&S.dateNF?et=S.dateNF:et=(S.table!=null?S.table:c)[v],et==null&&(et=S.table&&S.table[_[v]]||c[_[v]]),et==null&&(et=N[v]||"General");break}if(u(et,0))return U(A,S);A instanceof Date&&(A=q(A,S.date1904));var T=wt(et,A);if(u(T[1]))return U(A,S);if(A===!0)A="TRUE";else if(A===!1)A="FALSE";else if(A===""||A==null)return"";return z(T[1],A,S,T[0])}function dt(v,A){if(typeof A!="number"){A=+A||-1;for(var S=0;S<392;++S){if(c[S]==null){A<0&&(A=S);continue}if(c[S]==v){A=S;break}}A<0&&(A=391)}return c[A]=v,A}i.load=dt,i._table=c,i.get_table=function(){return c},i.load_table=function(A){for(var S=0;S!=392;++S)A[S]!==void 0&&dt(A[S],S)},i.init_table=m,i.format=kt};pi(hr);typeof Ee<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(Ee.exports=hr)});var _i={};_r(_i,{default:()=>mi});var Fe=se(Te(),1),Lt=class{constructor(i){this.zip=i}static async loadAsync(i){let s=await Fe.default.loadAsync(i);return new Lt(s)}async getXML(i){let s=this.zip.file(i);return s&&s.internalStream("string")}async close(){this.zip=null}};function Ne(r,i,s){r.on("data",e=>{s.stop?(r.pause(),i.close()):i.write(e)}),r.on("end",()=>{i.close()}),r.resume()}var ur=se(or(),1),Xt=se(lr(),1);function Ae(r,i){let s=Xt.default.get_table();function e(u,g){return new Promise((l,m)=>{if(!u)return l();let c=!0,_={stop:!1},b=()=>{_.stop=!0},N=()=>{c&&(c=!1,l())},R=new ur.SaxesParser;R.on("end",N),R.on("error",W=>{if(_.stop)return N();m(W)});let $=[],P;R.on("opentag",W=>{let{name:L,attributes:q}=W;$.unshift({name:L,attributes:q})}),R.on("text",W=>{P=W}),R.on("closetag",async W=>{$.shift();let{name:L,attributes:q}=W;W=P===void 0?{name:L,attributes:q}:{name:L,attributes:q,text:P},P=void 0;try{await g(L,W,[...$],b)}catch(nt){console.error(nt)}}),i(u,R,_)})}async function h(u){let g=[],l=0;return await e(u,(m,c,_)=>{m==="sheet"?g.push(c.attributes):m==="workbookView"&&c.attributes.activeTab&&(l=Number(c.attributes.activeTab))}),{sheets:g,activeTab:l}}async function o(u){let g={};return await e(u,(l,m,c)=>{if(l==="Relationship"){let{Id:_,Target:b}=m.attributes;g[_]=b}}),g}async function f(u){let g=[],l=[];return await e(u,(m,c,_)=>{m==="si"?(g.push(l.join("")),l=[]):m==="t"&&l.push(c.text)}),g}async function x(u){let g=[],l={};return await e(u,(m,c,_)=>{if(m==="numFmt"&&_[0].name==="numFmts"){let{numFmtId:b,formatCode:N}=c.attributes;l[b]=N}else if(m==="xf"&&_[0].name==="cellXfs"){let{numFmtId:b}=c.attributes;g.push(Number(b))}}),g=g.map(m=>l[m]||s[m]||m),g}function D(u){let{y:g,m:l,d:m,H:c,M:_,S:b}=Xt.default.parse_date_code(u),[N,R,$,P,W,L]=[g,l,m,c,_,b].map(q=>String(q).padStart(2,"0"));return`${N}-${R}-${$} ${P}:${W}:${L}`}function k(u){return u.replace(/[0-9]/g,"").split("").reduce((l,m)=>l*26+parseInt(m,36)-9,0)-1}async function E(u,g,l,m,c={}){let{max:_=1/0,collect:b=!1,json:N=!1}=c,R=null,$=[],P=[],W=0,L=0;return await e(u,(q,nt,C,U)=>{if(q==="row"||q==="x:row"){if(P.length>0&&!P.every(n=>n===""||n===void 0))if(L>_)U();else{let n=null;N?R?n=R.reduce((H,ht,X)=>({...H,[ht]:P[X]}),{}):R=P:n=P,n&&(b&&$.push(n),typeof m=="function"&&m(n)),L++}W=0,P=new Array(P.length)}else if(q==="v"||q==="x:v"){let n=C[0],H=n.attributes.t,ht=n.attributes.r,X=ht?k(ht):W,ut=n.attributes.s,G=nt.text||"";if(G=G.trim(),G.length>0){if(H==="s")G=g[G];else if(H==="b")G=G==="0"?"FALSE":"TRUE";else if(H==="e")G="";else if(ut){let at=parseFloat(G);if(!isNaN(at)){let M=l[ut];typeof M=="string"?Xt.default.is_date(M)?G=/[yd]/.test(M)?D(at):Xt.default.format(M,at):G=at:M?G=Xt.default.format(M,at):G=at}}}if(ht===void 0&&G==="")return;P[X]=G,W++}else if(q==="t"||q==="x:t"){let n=C[1],H=n.attributes.t,ht=n.attributes.r,X=ht?k(ht):W;H==="inlineStr"&&(P[X]=nt.text,W++)}}),$}return async function(g,l=console.log,m={}){let c=await r.loadAsync(g),_=await c.getXML("xl/workbook.xml"),{sheets:b,activeTab:N}=await h(_),R=await c.getXML("xl/sharedStrings.xml"),$=await f(R),P=await c.getXML("xl/styles.xml"),W=await x(P),L=await c.getXML("xl/_rels/workbook.xml.rels"),q=await o(L),nt=b.length>N?`xl/${q[b[N]["r:id"]].replace(/^\/xl\//,"")}`:"xl/worksheets/sheet1.xml",C=await c.getXML(nt),U=await E(C,$,W,l,m.sheet);return await c.close(),U}}var mi=Ae(Lt,Ne);return gr(_i);})();
xlsx2csv=xlsx2csv.default
